<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stephen Schueuerhuis">
<meta name="dcterms.date" content="2024-09-03">

<title>Two-stage group-sequential designs with delayed responses – what is the point of applying corresponding methods?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages"><span class="header-section-number">2</span> Load packages</a></li>
  <li><a href="#initialize-the-different-designs" id="toc-initialize-the-different-designs" class="nav-link" data-scroll-target="#initialize-the-different-designs"><span class="header-section-number">3</span> Initialize the different designs</a></li>
  <li><a href="#design-characteristics" id="toc-design-characteristics" class="nav-link" data-scroll-target="#design-characteristics"><span class="header-section-number">4</span> Design Characteristics</a>
  <ul class="collapse">
  <li><a href="#standard-group-sequential-design" id="toc-standard-group-sequential-design" class="nav-link" data-scroll-target="#standard-group-sequential-design"><span class="header-section-number">4.1</span> Standard group-sequential design</a></li>
  <li><a href="#delayed-response-group-sequential-design-according-to-hampson-and-jennison-2013" id="toc-delayed-response-group-sequential-design-according-to-hampson-and-jennison-2013" class="nav-link" data-scroll-target="#delayed-response-group-sequential-design-according-to-hampson-and-jennison-2013"><span class="header-section-number">4.2</span> Delayed response group-sequential design according to Hampson and Jennison (2013)</a></li>
  <li><a href="#delayed-response-group-sequential-design-with-double-rejection-criterion" id="toc-delayed-response-group-sequential-design-with-double-rejection-criterion" class="nav-link" data-scroll-target="#delayed-response-group-sequential-design-with-double-rejection-criterion"><span class="header-section-number">4.3</span> Delayed response group-sequential design with double rejection criterion</a></li>
  </ul></li>
  <li><a href="#evaluate-design-performance" id="toc-evaluate-design-performance" class="nav-link" data-scroll-target="#evaluate-design-performance"><span class="header-section-number">5</span> Evaluate design performance</a>
  <ul class="collapse">
  <li><a href="#standard-group-sequential-design-1" id="toc-standard-group-sequential-design-1" class="nav-link" data-scroll-target="#standard-group-sequential-design-1"><span class="header-section-number">5.1</span> Standard group-sequential design</a></li>
  <li><a href="#delayed-response-group-sequential-design-according-to-hampson-and-jennison-2013-1" id="toc-delayed-response-group-sequential-design-according-to-hampson-and-jennison-2013-1" class="nav-link" data-scroll-target="#delayed-response-group-sequential-design-according-to-hampson-and-jennison-2013-1"><span class="header-section-number">5.2</span> Delayed response group-sequential design according to Hampson and Jennison (2013)</a></li>
  <li><a href="#delayed-response-group-sequential-design-with-double-rejection-criterion-1" id="toc-delayed-response-group-sequential-design-with-double-rejection-criterion-1" class="nav-link" data-scroll-target="#delayed-response-group-sequential-design-with-double-rejection-criterion-1"><span class="header-section-number">5.3</span> Delayed response group-sequential design with double rejection criterion</a></li>
  </ul></li>
  <li><a href="#plot-performance" id="toc-plot-performance" class="nav-link" data-scroll-target="#plot-performance"><span class="header-section-number">6</span> Plot performance</a></li>
  <li><a href="#bringing-it-all-together" id="toc-bringing-it-all-together" class="nav-link" data-scroll-target="#bringing-it-all-together"><span class="header-section-number">7</span> Bringing it all together</a></li>
  <li><a href="#simulation-of-expected-sample-size" id="toc-simulation-of-expected-sample-size" class="nav-link" data-scroll-target="#simulation-of-expected-sample-size"><span class="header-section-number">8</span> Simulation of Expected Sample Size</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Two-stage group-sequential designs with delayed responses – what is the point of applying corresponding methods?</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Stephen Schueuerhuis </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 3, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This document provides code that is used to produce the results from the manuscript <em>“Two-stage group-sequential designs with delayed responses -- what is the point of applying corresponding methods?”</em>. Most functionalities used to produce the results are directly taken from the R package <code>rpact</code>.</p>
</section>
<section id="load-packages" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Load packages</h1>
<p>At first, the packages <code>rpact</code>, <code>ggplot2</code>, <code>mnormt</code> and <code>mvtnorm</code> need to be installed and loaded. The package <code>mnormt</code> is used to evaluate probabilities of multivariate normal distributions. The package <code>mvtnorm</code> is used to simulate data from a multivariate normal distribution. Additionally, some own written functions are imported.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Main package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(rpact)) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"rpact"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For plotting</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggplot2)) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For multivariate normal probabilities</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(mnormt)) {</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"mnormt"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># For simulation of test statistics</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(mvtnorm)) {</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"mvtnorm"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/utilities.R"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/double_rejection_design.R"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/power_means_double_rejection_approach.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="initialize-the-different-designs" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Initialize the different designs</h1>
<p>At first, we illustrate how to initialize the different designs under consideration.</p>
</section>
<section id="design-characteristics" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Design Characteristics</h1>
<p>We consider a two-stage group-sequential design with <span class="math inline">\(\alpha\)</span>- as well as <span class="math inline">\(\beta\)</span>-spending according to Pocock-type spending functions. During the planned interim analysis at <span class="math inline">\(I_1 = 0.5\)</span>, we assume that there is still <span class="math inline">\(I_{\Delta_t} = 0.3\)</span> of information outstanding. Different designs can be obtained by changing the inputs.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>informationRates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>delayedInformation <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>alphaSpending <span class="ot">&lt;-</span> <span class="st">"asP"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>betaSpending <span class="ot">&lt;-</span> <span class="st">"bsP"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For Table 4</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># informationRates &lt;- c(0.29,1)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># delayedInformation &lt;- 0.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="standard-group-sequential-design" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="standard-group-sequential-design"><span class="header-section-number">4.1</span> Standard group-sequential design</h2>
<p>At first, we consider a standard group-sequential design with a nonbinding futility boundary. In this option, we pretend as if there were no pipeline data since those would not be used during testing. This is done by setting <code>delayedInformation = 0</code> and <code>bindingFutility = FALSE</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>gsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sided =</span> <span class="dv">1</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> alphaSpending,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> betaSpending,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> <span class="dv">0</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gsDesign)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><em>Sequential analysis with a maximum of 2 looks (group sequential design)</em></p>
<p>Pocock type alpha spending design and Pocock type beta spending, non-binding futility, one-sided overall significance level 2.5%, power 80%, undefined endpoint, inflation factor 1.2767.</p>
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th>Stage</th>
<th>1</th>
<th>2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Planned information rate</td>
<td>50%</td>
<td>100%</td>
</tr>
<tr class="even">
<td>Efficacy boundary (z-value scale)</td>
<td>2.157</td>
<td>2.201</td>
</tr>
<tr class="odd">
<td>Stage levels (one-sided)</td>
<td>0.0155</td>
<td>0.0139</td>
</tr>
<tr class="even">
<td>Futility boundary (z-value scale)</td>
<td>1.083</td>
<td></td>
</tr>
<tr class="odd">
<td>Cumulative alpha spent</td>
<td>0.0155</td>
<td>0.0250</td>
</tr>
<tr class="even">
<td>Cumulative beta spent</td>
<td>0.1240</td>
<td>0.2000</td>
</tr>
<tr class="odd">
<td>Cumulative power</td>
<td>0.5324</td>
<td>0.8000</td>
</tr>
<tr class="even">
<td>Futility probabilities under H1</td>
<td>0.124</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="delayed-response-group-sequential-design-according-to-hampson-and-jennison-2013" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="delayed-response-group-sequential-design-according-to-hampson-and-jennison-2013"><span class="header-section-number">4.2</span> Delayed response group-sequential design according to Hampson and Jennison (2013)</h2>
<p>Secondly, we initialize the delayed response group-sequential design by Hampson and Jennison (2013). We, however, propose a slightly modified version which is such that the lower boundary is nonbinding. We initialize this design by setting <code>delayedInformation = 0.3</code> and, again, <code>bindingFutility = FALSE</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>drgsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sided =</span> <span class="dv">1</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> alphaSpending,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> betaSpending,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> delayedInformation,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(drgsDesign)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><em>Sequential analysis with a maximum of 2 looks (delayed response group sequential design)</em></p>
<p>Pocock type alpha spending design with delayed response and Pocock type beta spending, one-sided overall significance level 2.5%, power 80%, undefined endpoint, inflation factor 1.16.</p>
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th>Stage</th>
<th>1</th>
<th>2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Planned information rate</td>
<td>50%</td>
<td>100%</td>
</tr>
<tr class="even">
<td>Delayed information</td>
<td>30%</td>
<td></td>
</tr>
<tr class="odd">
<td>Upper bounds of continuation</td>
<td>2.157</td>
<td>2.201</td>
</tr>
<tr class="even">
<td>Stage levels (one-sided)</td>
<td>0.0155</td>
<td>0.0139</td>
</tr>
<tr class="odd">
<td>Lower bounds of continuation (non-binding)</td>
<td>1.083</td>
<td></td>
</tr>
<tr class="even">
<td>Cumulative alpha spent</td>
<td>0.0155</td>
<td>0.0250</td>
</tr>
<tr class="odd">
<td>Cumulative beta spent</td>
<td>0.1240</td>
<td>0.2000</td>
</tr>
<tr class="even">
<td>Cumulative power</td>
<td>0.5299</td>
<td>0.8000</td>
</tr>
<tr class="odd">
<td>Futility probabilities under H1</td>
<td>0.147</td>
<td></td>
</tr>
<tr class="even">
<td>Decision critical values</td>
<td>1.795</td>
<td>2.201</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="delayed-response-group-sequential-design-with-double-rejection-criterion" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="delayed-response-group-sequential-design-with-double-rejection-criterion"><span class="header-section-number">4.3</span> Delayed response group-sequential design with double rejection criterion</h2>
<p>Lastly, we create a delayed response design that we call <em>double rejection design</em>. For details, we refer to the corresponding manuscript. The accompanying file <code>getDoubleRejectionDesign.R</code>contains the design implementation, making use of the function <code>getGroupSequentialProbabilities()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>drDesign <span class="ot">&lt;-</span> <span class="fu">getDoubleRejectionDesign</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> alphaSpending,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> betaSpending,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> delayedInformation</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>drDesign</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$alpha
[1] 0.025

$beta
[1] 0.2

$alphaSpending
[1] "asP"

$betaSpending
[1] "bsP"

$informationRates
[1] 0.5 1.0

$delayedInformation
[1] 0.3

$upper
[1] 1.635638 1.959964 2.045181

$lower
[1] 0.6796584 2.0451809

$shift
[1] 9.144426

attr(,"class")
[1] "DoubleRejectionApproach"</code></pre>
</div>
</div>
</section>
</section>
<section id="evaluate-design-performance" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Evaluate design performance</h1>
<p>In this section, we evaluate the performance of the different design with respect to the parameters</p>
<ul>
<li>Probability to reject at interim</li>
<li>Probability to obtain futility stopping</li>
<li>Power</li>
<li>Expected sample size</li>
</ul>
<p>We consider different effect sizes <span class="math inline">\(\delta \in [-0.4, 0.8]\)</span> to cover effects falling under <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> as well. The overall maximum number of subjects for both arms is set to <code>maxNumberOfSubjects &lt;- 400</code> and the standard deviation is fixed at <span class="math inline">\(\sigma = 1\)</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>alternative <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="fl">0.05</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>stDev <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>maxNumberOfSubjects <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>nAlternative <span class="ot">&lt;-</span> <span class="fu">length</span>(alternative)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For Table 4</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># alternative &lt;- 1.6</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># stDev &lt;- 7.5</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># maxNumberOfSubjects &lt;- 2*345</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># nAlternative &lt;- length(alternative)</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, <span class="st">"drgsDesign"</span>, <span class="st">"drDesign"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>nMethods <span class="ot">&lt;-</span> <span class="fu">length</span>(methods)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="fu">rep</span>(alternative, nMethods),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">rejInterim =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">power =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">futility =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">expectedSampleSize =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">rep</span>(methods, <span class="at">each =</span> nAlternative)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="standard-group-sequential-design-1" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="standard-group-sequential-design-1"><span class="header-section-number">5.1</span> Standard group-sequential design</h2>
<p>To evaluate the performance of the standard group-sequential design, we use the function <code>getPowerMeans(design = gsDesign,...)</code>, which directly produces all required results. The expected sample size needs to be slightly adjusted as the output does not consider the additional pipeline data. More formally, the expected sample size in a delayed response design is given through <span class="math display">\[\begin{align}
E_{DR}[N] &amp;= (n_1 + n_{\Delta_t})P(early \, stopping) + n_{max}P(continue \,
to \, final) \\            &amp;= n_{\Delta_t}P(early \, stopping) + n_{1}P(early \, stopping)
+  n_{max}P(continue \,  to \, final) \\            &amp;= n_{\Delta_t}P(early \, stopping) +
E[N] \\ \end{align}\]</span> We achieve this slight adjustment by adding <code>(delayedInformation*maxNumberOfSubjects)*performance$earlyStop</code> to the calculated expected sample size.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeans</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> gsDesign,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">groups =</span> <span class="dv">2</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">normalApproximation =</span> T,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> alternative,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">stDev =</span> stDev,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nAlternative</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejectPerStage[<span class="dv">1</span>, ]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>overallReject</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>futilityStop</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedNumberOfSubjects <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    (delayedInformation <span class="sc">*</span> maxNumberOfSubjects) <span class="sc">*</span> performance<span class="sc">$</span>earlyStop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="delayed-response-group-sequential-design-according-to-hampson-and-jennison-2013-1" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="delayed-response-group-sequential-design-according-to-hampson-and-jennison-2013-1"><span class="header-section-number">5.2</span> Delayed response group-sequential design according to Hampson and Jennison (2013)</h2>
<p>The evaluation of the delayed response group-sequential design is done similarly to before. No adjustments to the expected sample size need to be made as the design inherently takes the pipeline data into account. Futility at interim is observed with probability <span class="math display">\[\begin{align}  P(futility) &amp;= P_{\delta}(Z_1 \notin
[l_1, u_1], \tilde{Z}_1 \leq \tilde{d}_1) \\              &amp;= P_{\delta}(Z_1 &gt; u_1,
\tilde{Z}_1 \leq \tilde{d}_1) + P_{\delta}(Z_1 &lt; l_1, \tilde{Z}_1 \leq
\tilde{d}_1). \end{align}\]</span></p>
<p>The calculation of this probability is done in the function<code>calcFutility()</code> based on the boundaries returned by <code>getDesignGroupSequential()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> nAlternative)<span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> nAlternative)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeans</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> drgsDesign,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">groups =</span> <span class="dv">2</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">normalApproximation =</span> T,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> alternative,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">stDev =</span> stDev,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejectPerStage[<span class="dv">1</span>, ]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>overallReject</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedNumberOfSubjects</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate futility probability</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>drgsDesignInformation <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    drgsDesign<span class="sc">$</span>informationRates[<span class="dv">1</span>],</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    drgsDesign<span class="sc">$</span>informationRates[<span class="dv">1</span>] <span class="sc">+</span> drgsDesign<span class="sc">$</span>delayedInformation[<span class="dv">1</span>],</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> <span class="fu">calcFutility</span>(</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fut =</span> drgsDesign<span class="sc">$</span>futilityBounds,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">crit =</span> drgsDesign<span class="sc">$</span>criticalValues,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec =</span> drgsDesign<span class="sc">$</span>decisionCriticalValues,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> alternative,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">stDev =</span> stDev,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> drgsDesignInformation</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="delayed-response-group-sequential-design-with-double-rejection-criterion-1" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="delayed-response-group-sequential-design-with-double-rejection-criterion-1"><span class="header-section-number">5.3</span> Delayed response group-sequential design with double rejection criterion</h2>
<p>For the double rejection approach, a user-written function for the calculation of the performance criteria is available in the file <code>getPowerMeansDoubleRejectionApproach.R</code>. The syntax is chosen in analogy to the <code>rpact</code> functions. Multivariate normal probabilities are evaluated using <code>sadmvn()</code> from the package <code>mnormt</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeansDoubleRejectionApproach</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> drDesign,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> alternative,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">stDev =</span> stDev,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> nAlternative))<span class="sc">:</span>(<span class="dv">3</span> <span class="sc">*</span> nAlternative)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejInterim</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>power</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>futility</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedSampleSize</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="plot-performance" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Plot performance</h1>
<p>We use <code>ggplot2</code> to plot the performance criteria for the different effects <span class="math inline">\(\delta \in [-0.4,0.8]\)</span>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual theme</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>themeSingle <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">"italic"</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of probabilities</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> alternative, <span class="at">y =</span> power, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">"Power"</span>)) <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="fu">aes</span>(</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> alternative, <span class="at">y =</span> rejInterim,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> method, <span class="at">linetype =</span> <span class="st">"Rej.Interim"</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="fu">aes</span>(</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> alternative, <span class="at">y =</span> futility,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> method, <span class="at">linetype =</span> <span class="st">"Futility"</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(delta)) <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative)),</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative), <span class="fl">0.1</span>), <span class="dv">3</span>)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen4"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Power"</span> <span class="ot">=</span> <span class="st">"solid"</span>,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Rej.Interim"</span> <span class="ot">=</span> <span class="st">"dashed"</span>,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Futility"</span> <span class="ot">=</span> <span class="st">"dotted"</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"Power"</span>, <span class="st">"Rej.Interim"</span>, <span class="st">"Futility"</span>)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    themeSingle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of expected sample size</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> alternative, <span class="at">y =</span> expectedSampleSize,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> method, <span class="at">color =</span> method</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(delta)) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"E[N]"</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative)),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative), <span class="fl">0.1</span>), <span class="dv">3</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>            (informationRates[<span class="dv">1</span>] <span class="sc">+</span> delayedInformation) <span class="sc">*</span> maxNumberOfSubjects <span class="sc">-</span> <span class="dv">20</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>            maxNumberOfSubjects</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>            informationRates[<span class="dv">1</span>] <span class="sc">*</span> maxNumberOfSubjects,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>            maxNumberOfSubjects, <span class="dv">20</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">yintercept =</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>            (informationRates[<span class="dv">1</span>] <span class="sc">+</span> delayedInformation) <span class="sc">*</span> maxNumberOfSubjects,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen4"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    themeSingle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bringing-it-all-together" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Bringing it all together</h1>
<p>Finally, we can do the calculations from above for different designs depending on the interim information <span class="math inline">\(I_1 \in \{0.3, 0.4, 0.5\}\)</span> and <span class="math inline">\(I_{\Delta_t} \in \{0.1, 0.2, 0.3\}\)</span> by iterating over the different scenarios in a for-loop. Finally, we again plot the results for different settings using <code>facet_grid()</code>. To obtain different scenarios, only input parameters must be changed.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Theme for multiple plots in one grid</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>theme_grid <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">"italic"</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Design parameters</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>interimInformation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>alphaSpending <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"asP"</span>, <span class="st">"asOF"</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>betaSpending <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bsP"</span>, <span class="st">"bsOF"</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>delayedInformation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect, standard deviation and sample size</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>alternative <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="fl">0.05</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>nAlternative <span class="ot">&lt;-</span> <span class="fu">length</span>(alternative)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>stDev <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>maxNumberOfSubjects <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving all considered cases in a data.frame()</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">interimInformation =</span> interimInformation,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">alphaSpending =</span> alphaSpending,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">betaSpending =</span> betaSpending,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> delayedInformation</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Input for typeOfDesign and typeBetaSpending should be character value</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>cases<span class="sc">$</span>alphaSpending <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cases<span class="sc">$</span>alphaSpending)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>cases<span class="sc">$</span>betaSpending <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cases<span class="sc">$</span>betaSpending)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only cases in which alpha and beta-spending match</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">&lt;-</span> cases[(cases<span class="sc">$</span>alphaSpending <span class="sc">==</span> <span class="st">"asOF"</span> <span class="sc">&amp;</span> cases<span class="sc">$</span>betaSpending <span class="sc">==</span> <span class="st">"bsOF"</span>) <span class="sc">|</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    (cases<span class="sc">$</span>alphaSpending <span class="sc">==</span> <span class="st">"asP"</span> <span class="sc">&amp;</span> cases<span class="sc">$</span>betaSpending <span class="sc">==</span> <span class="st">"bsP"</span>), ]</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of cases</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>nCases <span class="ot">&lt;-</span> <span class="fu">nrow</span>(cases)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co"># The three different methpods</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, <span class="st">"drgsDesign"</span>, <span class="st">"drDesign"</span>)</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>nMethods <span class="ot">&lt;-</span> <span class="fu">length</span>(methods)</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Placeholder for the results of a single setting</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">interimInformation =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nMethods <span class="sc">*</span> nAlternative),</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nMethods <span class="sc">*</span> nAlternative),</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">alphaSpending =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nMethods <span class="sc">*</span> nAlternative),</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">betaSpending =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nMethods <span class="sc">*</span> nAlternative),</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="fu">rep</span>(alternative, nMethods),</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">rejInterim =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">power =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">futility =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">expectedSampleSize =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">rep</span>(methods, <span class="at">each =</span> nAlternative)</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a><span class="co"># List in which results for all settings will be saved as data.frame()</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>results_all <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a><span class="co"># For-loop iterating over the different considered settings</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nCases) {</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialisation of gsDesign</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>    gsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">informationRates =</span> <span class="fu">c</span>(cases<span class="sc">$</span>interimInformation[i], <span class="dv">1</span>),</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">sided =</span> <span class="dv">1</span>,</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeOfDesign =</span> cases<span class="sc">$</span>alphaSpending[i],</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeBetaSpending =</span> cases<span class="sc">$</span>betaSpending[i],</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">delayedInformation =</span> <span class="dv">0</span>,</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nAlternative</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Performance evaluation of gsDesign</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>    performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeans</span>(</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">design =</span> gsDesign,</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">groups =</span> <span class="dv">2</span>,</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">normalApproximation =</span> T,</span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">alternative =</span> alternative,</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">stDev =</span> stDev,</span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejectPerStage[<span class="dv">1</span>, ]</span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>overallReject</span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>futilityStop</span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedNumberOfSubjects <span class="sc">+</span></span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>        (cases<span class="sc">$</span>delayedInformation[i] <span class="sc">*</span> maxNumberOfSubjects) <span class="sc">*</span> performance<span class="sc">$</span>earlyStop</span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialisation of drgsDesign</span></span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>    drgsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">informationRates =</span> <span class="fu">c</span>(cases<span class="sc">$</span>interimInformation[i], <span class="dv">1</span>),</span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">sided =</span> <span class="dv">1</span>,</span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeOfDesign =</span> cases<span class="sc">$</span>alphaSpending[i],</span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeBetaSpending =</span> cases<span class="sc">$</span>betaSpending[i],</span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>        <span class="at">delayedInformation =</span> cases<span class="sc">$</span>delayedInformation[i],</span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>        <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> nAlternative)<span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> nAlternative)</span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Performance evaluation of drgsDesign</span></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>    performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeans</span>(</span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>        <span class="at">design =</span> drgsDesign,</span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>        <span class="at">groups =</span> <span class="dv">2</span>,</span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>        <span class="at">normalApproximation =</span> T,</span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>        <span class="at">alternative =</span> alternative,</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>        <span class="at">stDev =</span> stDev,</span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejectPerStage[<span class="dv">1</span>, ]</span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>overallReject</span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedNumberOfSubjects</span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>    informationRatesUponDelay <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>        drgsDesign<span class="sc">$</span>informationRates[<span class="dv">1</span>],</span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a>        drgsDesign<span class="sc">$</span>informationRates[<span class="dv">1</span>] <span class="sc">+</span> drgsDesign<span class="sc">$</span>delayedInformation[<span class="dv">1</span>], <span class="dv">1</span></span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> <span class="fu">calcFutility</span>(</span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a>        <span class="at">fut =</span> drgsDesign<span class="sc">$</span>futilityBounds,</span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a>        <span class="at">crit =</span> drgsDesign<span class="sc">$</span>criticalValues,</span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a>        <span class="at">dec =</span> drgsDesign<span class="sc">$</span>decisionCriticalValues,</span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a>        <span class="at">alternative =</span> alternative,</span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a>        <span class="at">stDev =</span> stDev,</span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects,</span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a>        <span class="at">informationRates =</span> informationRatesUponDelay</span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialisation of drDesign</span></span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a>    drDesign <span class="ot">&lt;-</span> <span class="fu">getDoubleRejectionDesign</span>(</span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a>        <span class="at">informationRates =</span> <span class="fu">c</span>(cases<span class="sc">$</span>interimInformation[i], <span class="dv">1</span>),</span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeOfDesign =</span> cases<span class="sc">$</span>alphaSpending[i],</span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeBetaSpending =</span> cases<span class="sc">$</span>betaSpending[i],</span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a>        <span class="at">delayedInformation =</span> cases<span class="sc">$</span>delayedInformation[i]</span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> nAlternative))<span class="sc">:</span>(<span class="dv">3</span> <span class="sc">*</span> nAlternative)</span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Performance evaluation of drDesign</span></span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true" tabindex="-1"></a>    performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeansDoubleRejectionApproach</span>(</span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true" tabindex="-1"></a>        <span class="at">design =</span> drDesign,</span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true" tabindex="-1"></a>        <span class="at">alternative =</span> alternative,</span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true" tabindex="-1"></a>        <span class="at">stDev =</span> stDev,</span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-168"><a href="#cb13-168" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Saving everything in results</span></span>
<span id="cb13-169"><a href="#cb13-169" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejInterim</span>
<span id="cb13-170"><a href="#cb13-170" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>power</span>
<span id="cb13-171"><a href="#cb13-171" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>futility</span>
<span id="cb13-172"><a href="#cb13-172" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedSampleSize</span>
<span id="cb13-173"><a href="#cb13-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-174"><a href="#cb13-174" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save design characteristics as well</span></span>
<span id="cb13-175"><a href="#cb13-175" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>interimInformation <span class="ot">&lt;-</span> cases<span class="sc">$</span>interimInformation[i]</span>
<span id="cb13-176"><a href="#cb13-176" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>delayedInformation <span class="ot">&lt;-</span> cases<span class="sc">$</span>delayedInformation[i]</span>
<span id="cb13-177"><a href="#cb13-177" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>alphaSpending <span class="ot">&lt;-</span> cases<span class="sc">$</span>alphaSpending[i]</span>
<span id="cb13-178"><a href="#cb13-178" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>betaSpending <span class="ot">&lt;-</span> cases<span class="sc">$</span>betaSpending[i]</span>
<span id="cb13-179"><a href="#cb13-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-180"><a href="#cb13-180" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Saving results in the results_all list</span></span>
<span id="cb13-181"><a href="#cb13-181" aria-hidden="true" tabindex="-1"></a>    results_all[[i]] <span class="ot">&lt;-</span> results</span>
<span id="cb13-182"><a href="#cb13-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-183"><a href="#cb13-183" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Naming of the entries in results_all</span></span>
<span id="cb13-184"><a href="#cb13-184" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(results_all)[i] <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb13-185"><a href="#cb13-185" aria-hidden="true" tabindex="-1"></a>        cases<span class="sc">$</span>alphaSpending[i],</span>
<span id="cb13-186"><a href="#cb13-186" aria-hidden="true" tabindex="-1"></a>        cases<span class="sc">$</span>betaSpending[i], <span class="st">"I1="</span>, cases<span class="sc">$</span>interimInformation[i],</span>
<span id="cb13-187"><a href="#cb13-187" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Id ="</span>, cases<span class="sc">$</span>delayedInformation[i]</span>
<span id="cb13-188"><a href="#cb13-188" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-189"><a href="#cb13-189" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-190"><a href="#cb13-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-191"><a href="#cb13-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge results for all settings</span></span>
<span id="cb13-192"><a href="#cb13-192" aria-hidden="true" tabindex="-1"></a>results_all <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, results_all)</span>
<span id="cb13-193"><a href="#cb13-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-194"><a href="#cb13-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Pocock-like spending function; Change to "asOF" for O'Brien-Fleming-like spending function</span></span>
<span id="cb13-195"><a href="#cb13-195" aria-hidden="true" tabindex="-1"></a>results_all <span class="ot">&lt;-</span> results_all[results_all<span class="sc">$</span>alphaSpending <span class="sc">==</span> <span class="st">"asP"</span>, ]</span>
<span id="cb13-196"><a href="#cb13-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-197"><a href="#cb13-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilities plot</span></span>
<span id="cb13-198"><a href="#cb13-198" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(results_all, <span class="fu">aes</span>(<span class="at">x =</span> alternative, <span class="at">y =</span> power, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb13-199"><a href="#cb13-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.9</span>, <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">"Power"</span>)) <span class="sc">+</span></span>
<span id="cb13-200"><a href="#cb13-200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.9</span>, <span class="fu">aes</span>(</span>
<span id="cb13-201"><a href="#cb13-201" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> alternative, <span class="at">y =</span> rejInterim,</span>
<span id="cb13-202"><a href="#cb13-202" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> method, <span class="at">linetype =</span> <span class="st">"Rej.Interim"</span></span>
<span id="cb13-203"><a href="#cb13-203" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb13-204"><a href="#cb13-204" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.9</span>, <span class="fu">aes</span>(</span>
<span id="cb13-205"><a href="#cb13-205" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> alternative, <span class="at">y =</span> futility,</span>
<span id="cb13-206"><a href="#cb13-206" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> method, <span class="at">linetype =</span> <span class="st">"Futility"</span></span>
<span id="cb13-207"><a href="#cb13-207" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb13-208"><a href="#cb13-208" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(delayedInformation), <span class="at">cols =</span> <span class="fu">vars</span>(interimInformation)) <span class="sc">+</span></span>
<span id="cb13-209"><a href="#cb13-209" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(delta)) <span class="sc">+</span></span>
<span id="cb13-210"><a href="#cb13-210" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb13-211"><a href="#cb13-211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb13-212"><a href="#cb13-212" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative)),</span>
<span id="cb13-213"><a href="#cb13-213" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative), <span class="fl">0.2</span>), <span class="dv">3</span>),</span>
<span id="cb13-214"><a href="#cb13-214" aria-hidden="true" tabindex="-1"></a>        <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.,</span>
<span id="cb13-215"><a href="#cb13-215" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Interim Information "</span>, I[<span class="dv">1</span>])),</span>
<span id="cb13-216"><a href="#cb13-216" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="cn">NULL</span></span>
<span id="cb13-217"><a href="#cb13-217" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb13-218"><a href="#cb13-218" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-219"><a href="#cb13-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.,</span>
<span id="cb13-220"><a href="#cb13-220" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Amount of Pipeline Data "</span>, I[Delta[t]])),</span>
<span id="cb13-221"><a href="#cb13-221" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="cn">NULL</span></span>
<span id="cb13-222"><a href="#cb13-222" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb13-223"><a href="#cb13-223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb13-224"><a href="#cb13-224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb13-225"><a href="#cb13-225" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb13-226"><a href="#cb13-226" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Power"</span> <span class="ot">=</span> <span class="st">"solid"</span>,</span>
<span id="cb13-227"><a href="#cb13-227" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Rej.Interim"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"Futility"</span> <span class="ot">=</span> <span class="st">"dotted"</span></span>
<span id="cb13-228"><a href="#cb13-228" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb13-229"><a href="#cb13-229" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"Power"</span>, <span class="st">"Rej.Interim"</span>, <span class="st">"Futility"</span>)</span>
<span id="cb13-230"><a href="#cb13-230" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-231"><a href="#cb13-231" aria-hidden="true" tabindex="-1"></a>    theme_grid</span>
<span id="cb13-232"><a href="#cb13-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-233"><a href="#cb13-233" aria-hidden="true" tabindex="-1"></a><span class="co"># If the lines are overlapping, geom_path() can be used alternatively to</span></span>
<span id="cb13-234"><a href="#cb13-234" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_line() to slightly shift the lines using position_dodge();</span></span>
<span id="cb13-235"><a href="#cb13-235" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment the code below in that case.</span></span>
<span id="cb13-236"><a href="#cb13-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-237"><a href="#cb13-237" aria-hidden="true" tabindex="-1"></a><span class="co"># power &lt;- ggplot(results_all, aes(x = alternative, y = power, color = method)) +</span></span>
<span id="cb13-238"><a href="#cb13-238" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(position = position_dodge(width = 0.02), size = 0.9, aes(linetype = "Power")) +</span></span>
<span id="cb13-239"><a href="#cb13-239" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(position = position_dodge(width = 0.02), size = 0.9, aes(x = alternative, y = rejInterim, group = method, linetype = "Rej.Interim")) +</span></span>
<span id="cb13-240"><a href="#cb13-240" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(position = position_dodge(width = 0.02), size = 0.9, aes(x = alternative, y = futility, group = method, linetype = "Futility")) +</span></span>
<span id="cb13-241"><a href="#cb13-241" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(rows = vars(delayedInformation), cols = vars(interimInformation)) +</span></span>
<span id="cb13-242"><a href="#cb13-242" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab(expression(delta)) +</span></span>
<span id="cb13-243"><a href="#cb13-243" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Probability") +</span></span>
<span id="cb13-244"><a href="#cb13-244" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(limits = c(min(alternative), max(alternative)), breaks = round(seq(min(alternative),max(alternative),0.2),3),</span></span>
<span id="cb13-245"><a href="#cb13-245" aria-hidden="true" tabindex="-1"></a><span class="co">#                      sec.axis = sec_axis(~ . , name = expression(paste("Interim Information ", I[1])), breaks = NULL, labels = NULL)) +</span></span>
<span id="cb13-246"><a href="#cb13-246" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(sec.axis = sec_axis(~ . , name = expression(paste("Amount of Pipeline Data ", I[Delta[t]])), breaks = NULL, labels = NULL)) +</span></span>
<span id="cb13-247"><a href="#cb13-247" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_manual(values = c("seagreen", "orange2", "blue")) +</span></span>
<span id="cb13-248"><a href="#cb13-248" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_linetype_manual(values = c("Power" = "solid", "Rej.Interim" = "dashed", "Futility" = "dotted"), breaks = c("Power", "Rej.Interim", "Futility")) +</span></span>
<span id="cb13-249"><a href="#cb13-249" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_grid</span></span>
<span id="cb13-250"><a href="#cb13-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-251"><a href="#cb13-251" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected sample size plot</span></span>
<span id="cb13-252"><a href="#cb13-252" aria-hidden="true" tabindex="-1"></a>eN <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(results_all, <span class="fu">aes</span>(<span class="at">x =</span> alternative, <span class="at">y =</span> expectedSampleSize, <span class="at">linetype =</span> method, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb13-253"><a href="#cb13-253" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb13-254"><a href="#cb13-254" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(delayedInformation), <span class="at">cols =</span> <span class="fu">vars</span>(interimInformation), <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb13-255"><a href="#cb13-255" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(delta)) <span class="sc">+</span></span>
<span id="cb13-256"><a href="#cb13-256" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"E[N]"</span>) <span class="sc">+</span></span>
<span id="cb13-257"><a href="#cb13-257" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb13-258"><a href="#cb13-258" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative)), <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative), <span class="fl">0.2</span>), <span class="dv">3</span>),</span>
<span id="cb13-259"><a href="#cb13-259" aria-hidden="true" tabindex="-1"></a>        <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>., <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Interim Information "</span>, I[<span class="dv">1</span>])), <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="cn">NULL</span>)</span>
<span id="cb13-260"><a href="#cb13-260" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-261"><a href="#cb13-261" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>., <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Amount of Pipeline Data "</span>, I[Delta[t]])), <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="cn">NULL</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">400</span>)) <span class="sc">+</span></span>
<span id="cb13-262"><a href="#cb13-262" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb13-263"><a href="#cb13-263" aria-hidden="true" tabindex="-1"></a>    theme_grid</span>
<span id="cb13-264"><a href="#cb13-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-265"><a href="#cb13-265" aria-hidden="true" tabindex="-1"></a><span class="co"># If the lines are overlapping, geom_path() can be used alternatively to geom_line() to slightly shift the lines using position_dodge() ; Uncomment the code below in that case</span></span>
<span id="cb13-266"><a href="#cb13-266" aria-hidden="true" tabindex="-1"></a><span class="co"># eN &lt;- ggplot(results_all, aes(x = alternative, y = expectedSampleSize, linetype = method, color = method)) +</span></span>
<span id="cb13-267"><a href="#cb13-267" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(position = position_dodge(width = 0.02), size = 0.9) +  # Using geom_path instead of geom_line for dodging</span></span>
<span id="cb13-268"><a href="#cb13-268" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(rows = vars(delayedInformation), cols = vars(interimInformation), scales = "free") +</span></span>
<span id="cb13-269"><a href="#cb13-269" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab(expression(delta)) +</span></span>
<span id="cb13-270"><a href="#cb13-270" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("E[N]") +</span></span>
<span id="cb13-271"><a href="#cb13-271" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(limits = c(min(alternative), max(alternative)), breaks = round(seq(min(alternative),max(alternative),0.2),3),</span></span>
<span id="cb13-272"><a href="#cb13-272" aria-hidden="true" tabindex="-1"></a><span class="co">#                      sec.axis = sec_axis(~ . , name = expression(paste("Interim Information ", I[1])), breaks = NULL, labels = NULL)) +</span></span>
<span id="cb13-273"><a href="#cb13-273" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(sec.axis = sec_axis(~ . , name = expression(paste("Amount of Pipeline Data ", I[Delta[t]])), breaks = NULL, labels = NULL), limits = c(160, 400)) +</span></span>
<span id="cb13-274"><a href="#cb13-274" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_manual(values = c("seagreen", "orange2", "blue")) +</span></span>
<span id="cb13-275"><a href="#cb13-275" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_grid</span></span>
<span id="cb13-276"><a href="#cb13-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-277"><a href="#cb13-277" aria-hidden="true" tabindex="-1"></a>power</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>eN</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="simulation-of-expected-sample-size" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Simulation of Expected Sample Size</h1>
<p>The actual sample size as well as the power are directly dependent upon the joint distribution of the test statistics. If the statistics are known to follow a normal distribution, formulas to do calculations of location components are readily available. In our manuscript, we argue that also variance components (such as <span class="math inline">\(Var_{\delta}(N)\)</span>) should be considered in performance evaluation. However, no straightforward formulas for the calculation of the variance of sample size and power exist. Therefore, we use simulation to obtain an empirical distribution of the random variables.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>maxNumberOfSubjects <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>interimInformation <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>delayedInformation <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>alternative <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>stDev <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Design parameters</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.025</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>informationRates <span class="ot">&lt;-</span> <span class="fu">c</span>(interimInformation, <span class="dv">1</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>typeOfDesign <span class="ot">&lt;-</span> <span class="st">"asOF"</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>typeBetaSpending <span class="ot">&lt;-</span> <span class="st">"bsOF"</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># True means and covariance matrix</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>informationRatesUponDelay <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    interimInformation,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    interimInformation <span class="sc">+</span> delayedInformation, <span class="dv">1</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> alternative <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> stDev<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(informationRatesUponDelay <span class="sc">*</span> maxNumberOfSubjects <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">getCovarianceFromInformation</span>(informationRatesUponDelay)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frame to store results</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>resultsSim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Method =</span> <span class="fu">character</span>(nsim),</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Power =</span> <span class="fu">numeric</span>(nsim),</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">expectedNumberOfSubjects =</span> <span class="fu">numeric</span>(nsim),</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Group-sequential design</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>gsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> beta,</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> typeOfDesign,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> typeBetaSpending,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Delayed response group-sequential design</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>drgsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha,</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> beta,</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> typeOfDesign,</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> delayedInformation,</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> typeBetaSpending,</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Double Rejection Design</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>drDesign <span class="ot">&lt;-</span> <span class="fu">getDoubleRejectionDesign</span>(</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha,</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> beta,</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> typeOfDesign,</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> typeBetaSpending,</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> delayedInformation</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="dv">19032024</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed <span class="sc">+</span> i)</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulating multivariate normal random variables as test statistics</span></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>    statistics <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> mu, <span class="at">sigma =</span> sigma)</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>    Z1 <span class="ot">&lt;-</span> statistics[, <span class="dv">1</span>]</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>    Z1tilde <span class="ot">&lt;-</span> statistics[, <span class="dv">2</span>]</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>    Z12 <span class="ot">&lt;-</span> statistics[, <span class="dv">3</span>]</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate power and expected sample size values for all designs</span></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>    powerGSD <span class="ot">&lt;-</span> <span class="fu">mean</span>((Z1 <span class="sc">&gt;</span> gsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>]) <span class="sc">|</span></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>        (gsDesign<span class="sc">$</span>futilityBounds <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span> Z1 <span class="sc">&lt;</span> gsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>            Z12 <span class="sc">&gt;</span> gsDesign<span class="sc">$</span>criticalValues[<span class="dv">2</span>]))</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>    eNGSD <span class="ot">&lt;-</span> <span class="fu">mean</span>(informationRatesUponDelay[<span class="dv">2</span>] <span class="sc">*</span></span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>        maxNumberOfSubjects <span class="sc">*</span> (Z1 <span class="sc">&gt;</span> gsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>] <span class="sc">|</span></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>            (Z1 <span class="sc">&lt;</span> gsDesign<span class="sc">$</span>futilityBounds[<span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>        maxNumberOfSubjects <span class="sc">*</span> (gsDesign<span class="sc">$</span>futilityBounds <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span> Z1 <span class="sc">&lt;</span> gsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>]))</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>    powerDRGSD <span class="ot">&lt;-</span> <span class="fu">mean</span>((Z1 <span class="sc">&gt;</span> drgsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>        Z1tilde <span class="sc">&gt;</span> drgsDesign<span class="sc">$</span>decisionCriticalValues[<span class="dv">1</span>]) <span class="sc">|</span></span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>        (Z1 <span class="sc">&lt;</span> drgsDesign<span class="sc">$</span>futilityBounds[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>            Z1tilde <span class="sc">&gt;</span> drgsDesign<span class="sc">$</span>decisionCriticalValues[<span class="dv">1</span>]) <span class="sc">|</span></span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>        (drgsDesign<span class="sc">$</span>futilityBounds[<span class="dv">1</span>] <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>            Z1 <span class="sc">&lt;</span> drgsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>            Z12 <span class="sc">&gt;</span> drgsDesign<span class="sc">$</span>decisionCriticalValues[<span class="dv">2</span>]))</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>    eNDRGSD <span class="ot">&lt;-</span> <span class="fu">mean</span>(informationRatesUponDelay[<span class="dv">2</span>] <span class="sc">*</span> maxNumberOfSubjects <span class="sc">*</span></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>        ((Z1 <span class="sc">&gt;</span> drgsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>]) <span class="sc">|</span></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>            (Z1 <span class="sc">&lt;</span> drgsDesign<span class="sc">$</span>futilityBounds[<span class="dv">1</span>])) <span class="sc">+</span> maxNumberOfSubjects <span class="sc">*</span></span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>            (drgsDesign<span class="sc">$</span>futilityBounds[<span class="dv">1</span>] <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span> Z1 <span class="sc">&lt;</span> drgsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>]))</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>    powerDRD <span class="ot">&lt;-</span> <span class="fu">mean</span>((Z1 <span class="sc">&gt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">1</span>] <span class="sc">&amp;</span> Z1tilde <span class="sc">&gt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">2</span>]) <span class="sc">|</span></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>        (drDesign<span class="sc">$</span>lower[<span class="dv">1</span>] <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span> Z1 <span class="sc">&lt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">1</span>] <span class="sc">&amp;</span> Z12 <span class="sc">&gt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">3</span>]))</span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>    enDRD <span class="ot">&lt;-</span> <span class="fu">mean</span>(informationRatesUponDelay[<span class="dv">2</span>] <span class="sc">*</span> maxNumberOfSubjects <span class="sc">*</span></span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>        (Z1 <span class="sc">&gt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">1</span>] <span class="sc">|</span> Z1 <span class="sc">&lt;</span> drDesign<span class="sc">$</span>lower[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>        maxNumberOfSubjects <span class="sc">*</span> (drDesign<span class="sc">$</span>lower[<span class="dv">1</span>] <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span> Z1 <span class="sc">&lt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">1</span>]))</span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save results in data frame</span></span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>    resultsSim[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, powerGSD, eNGSD)</span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>    resultsSim[i <span class="sc">+</span> nsim, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"drgsDesign"</span>, powerDRGSD, eNDRGSD)</span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>    resultsSim[i <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> nsim, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"drDesign"</span>, powerDRD, enDRD)</span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Save results</span></span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>resultsSim<span class="sc">$</span>Method <span class="ot">&lt;-</span> <span class="fu">factor</span>(resultsSim<span class="sc">$</span>Method,</span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, <span class="st">"drgsDesign"</span>, <span class="st">"drDesign"</span>),</span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>resultsSim<span class="sc">$</span>Power <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(resultsSim<span class="sc">$</span>Power)</span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>resultsSim<span class="sc">$</span>eN <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(resultsSim<span class="sc">$</span>expectedNumberOfSubjects)</span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Theme for plotting simulation results</span></span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>theme_sim <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Power simulation</span></span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>power_sim <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(resultsSim, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> Power, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, <span class="st">"drgsDesign"</span>, <span class="st">"drDesign"</span>)) <span class="sc">+</span></span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.82</span>, <span class="fl">0.85</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.82</span>, <span class="fl">0.83</span>, <span class="fl">0.84</span>, <span class="fl">0.85</span>)) <span class="sc">+</span></span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Simulated Power"</span>) <span class="sc">+</span></span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen4"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>    theme_sim</span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected sample size simulation</span></span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a>eN_sim <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(resultsSim, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> eN, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, <span class="st">"drgsDesign"</span>, <span class="st">"drDesign"</span>)) <span class="sc">+</span></span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">366</span>, <span class="dv">372</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">366</span>, <span class="dv">368</span>, <span class="dv">370</span>, <span class="dv">372</span>)) <span class="sc">+</span></span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"E[N]"</span>) <span class="sc">+</span></span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen4"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a>    theme_sim</span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>power_sim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>eN_sim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>System: rpact 4.0.0, R version 4.4.1 (2024-06-14), platform: x86_64-pc-linux-gnu</p>
<p>To cite R in publications use:</p>
<p>R Core Team (2024). <em>R: A Language and Environment for Statistical Computing</em>. R Foundation for Statistical Computing, Vienna, Austria. <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>. To cite package ‘rpact’ in publications use:</p>
<p>Wassmer G, Pahlke F (2024). <em>rpact: Confirmatory Adaptive Clinical Trial Design and Analysis</em>. R package version 4.0.0, <a href="https://CRAN.R-project.org/package=rpact" class="uri">https://CRAN.R-project.org/package=rpact</a>.</p>
<!-- -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div>MIT</div></div></section><section class="quarto-appendix-contents" id="quarto-copyright"><h2 class="anchored quarto-appendix-heading">Copyright</h2><div class="quarto-appendix-contents"><div>Stephen Schueuerhuis</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Two-stage group-sequential designs with delayed responses -- what is the point of applying corresponding methods?"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Stephen Schueuerhuis"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="an">contributor:</span><span class="co"> "Friedrich Pahlke"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> last-modified                                              </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual                  </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true                        </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc_float:</span><span class="co"> true               </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true          </span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="an">colorlinks:</span><span class="co"> true                            </span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="an">highlight-style:</span><span class="co"> pygments   </span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="an">license:</span><span class="co"> MIT</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="an">copyright:</span><span class="co"> Stephen Schueuerhuis</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false                  </span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false                </span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show             </span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true            </span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true            </span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"rpact.summary.output.size"</span> <span class="ot">=</span> <span class="st">"medium"</span>)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"rpact.summary.intervalFormat"</span> <span class="ot">=</span> <span class="st">"[%s; %s]"</span>)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"rpact.summary.justify"</span> <span class="ot">=</span> <span class="st">"left"</span>)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>This document provides code that is used to produce the results from the</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>manuscript *"Two-stage group-sequential designs with delayed responses <span class="sc">\-</span>- what</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>is the point of applying corresponding methods?"*. Most functionalities used to</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>produce the results are directly taken from the R package <span class="in">`rpact`</span>.</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="fu"># Load packages</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>At first, the packages <span class="in">`rpact`</span>, <span class="in">`ggplot2`</span>, <span class="in">`mnormt`</span> and <span class="in">`mvtnorm`</span> need to be</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>installed and loaded. The package <span class="in">`mnormt`</span> is used to evaluate probabilities of</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>multivariate normal distributions. The package <span class="in">`mvtnorm`</span> is used to simulate</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>data from a multivariate normal distribution. Additionally, some own written</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>functions are imported.</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Main package</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(rpact)) {</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"rpact"</span>)</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="co"># For plotting</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggplot2)) {</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="co"># For multivariate normal probabilities</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(mnormt)) {</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"mnormt"</span>)</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="co"># For simulation of test statistics</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(mvtnorm)) {</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"mvtnorm"</span>)</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/utilities.R"</span>)</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/double_rejection_design.R"</span>)</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/power_means_double_rejection_approach.R"</span>)</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="fu"># Initialize the different designs</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>At first, we illustrate how to initialize the different designs under consideration.</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="fu"># Design Characteristics</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>We consider a two-stage group-sequential design with $\alpha$- as well as</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>$\beta$-spending according to Pocock-type spending functions. During the planned</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>interim analysis at $I_1 = 0.5$, we assume that there is still</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>$I_{\Delta_t} = 0.3$ of information outstanding. Different designs can be</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>obtained by changing the inputs.</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>informationRates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>)</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>delayedInformation <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>alphaSpending <span class="ot">&lt;-</span> <span class="st">"asP"</span></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>betaSpending <span class="ot">&lt;-</span> <span class="st">"bsP"</span></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a><span class="co"># For Table 4</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="co"># informationRates &lt;- c(0.29,1)</span></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a><span class="co"># delayedInformation &lt;- 0.3</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## Standard group-sequential design</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>At first, we consider a standard group-sequential design with a nonbinding</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>futility boundary. In this option, we pretend as if there were no pipeline data</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>since those would not be used during testing. This is done by setting</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a><span class="in">`delayedInformation = 0`</span> and <span class="in">`bindingFutility = FALSE`</span>.</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>gsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">sided =</span> <span class="dv">1</span>,</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> alphaSpending,</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> betaSpending,</span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> <span class="dv">0</span>,</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gsDesign)</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a><span class="fu">## Delayed response group-sequential design according to Hampson and Jennison (2013)</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>Secondly, we initialize the delayed response group-sequential design by Hampson</span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>and Jennison (2013). We, however, propose a slightly modified version which is</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>such that the lower boundary is nonbinding. We initialize this design by setting</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a><span class="in">`delayedInformation = 0.3`</span> and, again, <span class="in">`bindingFutility = FALSE`</span>.</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>drgsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">sided =</span> <span class="dv">1</span>,</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> alphaSpending,</span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> betaSpending,</span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> delayedInformation,</span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(drgsDesign)</span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a><span class="fu">## Delayed response group-sequential design with double rejection criterion</span></span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>Lastly, we create a delayed response design that we call *double rejection</span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>design*. For details, we refer to the corresponding manuscript. The accompanying</span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>file <span class="in">`getDoubleRejectionDesign.R`</span>contains the design implementation, making use</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>of the function <span class="in">`getGroupSequentialProbabilities()`</span>.</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>drDesign <span class="ot">&lt;-</span> <span class="fu">getDoubleRejectionDesign</span>(</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> alphaSpending,</span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> betaSpending,</span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> delayedInformation</span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>drDesign</span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a><span class="fu"># Evaluate design performance</span></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a>In this section, we evaluate the performance of the different design with</span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a>respect to the parameters</span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Probability to reject at interim</span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Probability to obtain futility stopping</span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Power</span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Expected sample size</span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>We consider different effect sizes $\delta \in <span class="co">[</span><span class="ot">-0.4, 0.8</span><span class="co">]</span>$ to cover effects</span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a>falling under $H_0$ and $H_1$ as well. The overall maximum number of subjects</span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>for both arms is set to <span class="in">`maxNumberOfSubjects &lt;- 400`</span> and the standard deviation</span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>is fixed at $\sigma = 1$</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>alternative <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="fl">0.05</span>)</span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>stDev <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>maxNumberOfSubjects <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a>nAlternative <span class="ot">&lt;-</span> <span class="fu">length</span>(alternative)</span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a><span class="co"># For Table 4</span></span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a><span class="co"># alternative &lt;- 1.6</span></span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a><span class="co"># stDev &lt;- 7.5</span></span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a><span class="co"># maxNumberOfSubjects &lt;- 2*345</span></span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a><span class="co"># nAlternative &lt;- length(alternative)</span></span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, <span class="st">"drgsDesign"</span>, <span class="st">"drDesign"</span>)</span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>nMethods <span class="ot">&lt;-</span> <span class="fu">length</span>(methods)</span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="fu">rep</span>(alternative, nMethods),</span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>    <span class="at">rejInterim =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">power =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>    <span class="at">futility =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">expectedSampleSize =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">rep</span>(methods, <span class="at">each =</span> nAlternative)</span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a><span class="fu">## Standard group-sequential design</span></span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a>To evaluate the performance of the standard group-sequential design, we use the</span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a>function <span class="in">`getPowerMeans(design = gsDesign,...)`</span>, which directly produces all required</span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>results. The expected sample size needs to be slightly adjusted as the output</span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a>does not consider the additional pipeline data. More formally, the expected</span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a>sample size in a delayed response design is given through \begin{align}</span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a> E_{DR}<span class="co">[</span><span class="ot">N</span><span class="co">]</span> &amp;= (n_1 + n_{\Delta_t})P(early \, stopping) + n_{max}P(continue \,</span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a>to \, final) <span class="sc">\\</span>            &amp;= n_{\Delta_t}P(early \, stopping) + n_{1}P(early \, stopping)</span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a><span class="ss">+  </span>n_{max}P(continue \,  to \, final) \\            &amp;= n_{\Delta_t}P(early \, stopping) +</span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>E<span class="co">[</span><span class="ot">N</span><span class="co">]</span> <span class="sc">\\</span> \end{align} We achieve this slight adjustment by adding</span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a><span class="in">`(delayedInformation*maxNumberOfSubjects)*performance$earlyStop`</span> to the</span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>calculated expected sample size.</span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeans</span>(</span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> gsDesign,</span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">groups =</span> <span class="dv">2</span>,</span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">normalApproximation =</span> T,</span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> alternative,</span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a>    <span class="at">stDev =</span> stDev,</span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nAlternative</span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejectPerStage[<span class="dv">1</span>, ]</span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>overallReject</span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>futilityStop</span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedNumberOfSubjects <span class="sc">+</span></span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a>    (delayedInformation <span class="sc">*</span> maxNumberOfSubjects) <span class="sc">*</span> performance<span class="sc">$</span>earlyStop</span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a><span class="fu">## Delayed response group-sequential design according to Hampson and Jennison (2013)</span></span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a>The evaluation of the delayed response group-sequential design is done similarly</span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a>to before. No adjustments to the expected sample size need to be made as the</span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a>design inherently takes the pipeline data into account. Futility at interim is</span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a>observed with probability \begin{align}  P(futility) &amp;= P_{\delta}(Z_1 \notin</span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">l_1, u_1</span><span class="co">]</span>, \tilde{Z}_1 \leq \tilde{d}_1) \\              &amp;= P_{\delta}(Z_1 &gt; u_1,</span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>\tilde{Z}_1 \leq \tilde{d}_1) + P_{\delta}(Z_1 &lt; l_1, \tilde{Z}_1 \leq</span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>\tilde{d}_1). \end{align}</span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a>The calculation of this probability is done in the function<span class="in">`calcFutility()`</span></span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a>based on the boundaries returned by <span class="in">`getDesignGroupSequential()`</span>.</span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> nAlternative)<span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> nAlternative)</span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeans</span>(</span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> drgsDesign,</span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a>    <span class="at">groups =</span> <span class="dv">2</span>,</span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a>    <span class="at">normalApproximation =</span> T,</span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> alternative,</span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a>    <span class="at">stDev =</span> stDev,</span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejectPerStage[<span class="dv">1</span>, ]</span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>overallReject</span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedNumberOfSubjects</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate futility probability</span></span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a>drgsDesignInformation <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a>    drgsDesign<span class="sc">$</span>informationRates[<span class="dv">1</span>],</span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>    drgsDesign<span class="sc">$</span>informationRates[<span class="dv">1</span>] <span class="sc">+</span> drgsDesign<span class="sc">$</span>delayedInformation[<span class="dv">1</span>],</span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span></span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> <span class="fu">calcFutility</span>(</span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a>    <span class="at">fut =</span> drgsDesign<span class="sc">$</span>futilityBounds,</span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a>    <span class="at">crit =</span> drgsDesign<span class="sc">$</span>criticalValues,</span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec =</span> drgsDesign<span class="sc">$</span>decisionCriticalValues,</span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> alternative,</span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a>    <span class="at">stDev =</span> stDev,</span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects,</span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> drgsDesignInformation</span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a><span class="fu">## Delayed response group-sequential design with double rejection criterion</span></span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>For the double rejection approach, a user-written function for the calculation</span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a>of the performance criteria is available in the file</span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a><span class="in">`getPowerMeansDoubleRejectionApproach.R`</span>. The syntax is chosen in analogy to the</span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a><span class="in">`rpact`</span> functions. Multivariate normal probabilities are evaluated using</span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a><span class="in">`sadmvn()`</span> from the package <span class="in">`mnormt`</span>.</span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeansDoubleRejectionApproach</span>(</span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> drDesign,</span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> alternative,</span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a>    <span class="at">stDev =</span> stDev,</span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> nAlternative))<span class="sc">:</span>(<span class="dv">3</span> <span class="sc">*</span> nAlternative)</span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejInterim</span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>power</span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>futility</span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedSampleSize</span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a><span class="fu"># Plot performance</span></span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a>We use <span class="in">`ggplot2`</span> to plot the performance criteria for the different effects</span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a>$\delta \in <span class="co">[</span><span class="ot">-0.4,0.8</span><span class="co">]</span>$.</span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual theme</span></span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a>themeSingle <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">"italic"</span></span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of probabilities</span></span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> alternative, <span class="at">y =</span> power, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">"Power"</span>)) <span class="sc">+</span></span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="fu">aes</span>(</span>
<span id="cb17-370"><a href="#cb17-370" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> alternative, <span class="at">y =</span> rejInterim,</span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> method, <span class="at">linetype =</span> <span class="st">"Rej.Interim"</span></span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="fu">aes</span>(</span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> alternative, <span class="at">y =</span> futility,</span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> method, <span class="at">linetype =</span> <span class="st">"Futility"</span></span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(delta)) <span class="sc">+</span></span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span></span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative)),</span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative), <span class="fl">0.1</span>), <span class="dv">3</span>)</span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-383"><a href="#cb17-383" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen4"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb17-384"><a href="#cb17-384" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Power"</span> <span class="ot">=</span> <span class="st">"solid"</span>,</span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Rej.Interim"</span> <span class="ot">=</span> <span class="st">"dashed"</span>,</span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Futility"</span> <span class="ot">=</span> <span class="st">"dotted"</span></span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"Power"</span>, <span class="st">"Rej.Interim"</span>, <span class="st">"Futility"</span>)</span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a>    themeSingle</span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of expected sample size</span></span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(</span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> alternative, <span class="at">y =</span> expectedSampleSize,</span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> method, <span class="at">color =</span> method</span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(delta)) <span class="sc">+</span></span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"E[N]"</span>) <span class="sc">+</span></span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative)),</span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative), <span class="fl">0.1</span>), <span class="dv">3</span>)</span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(</span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a>            (informationRates[<span class="dv">1</span>] <span class="sc">+</span> delayedInformation) <span class="sc">*</span> maxNumberOfSubjects <span class="sc">-</span> <span class="dv">20</span>,</span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a>            maxNumberOfSubjects</span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(</span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a>            informationRates[<span class="dv">1</span>] <span class="sc">*</span> maxNumberOfSubjects,</span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a>            maxNumberOfSubjects, <span class="dv">20</span></span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb17-415"><a href="#cb17-415" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a>        <span class="at">yintercept =</span></span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a>            (informationRates[<span class="dv">1</span>] <span class="sc">+</span> delayedInformation) <span class="sc">*</span> maxNumberOfSubjects,</span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen4"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a>    themeSingle</span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-425"><a href="#cb17-425" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bringing it all together</span></span>
<span id="cb17-426"><a href="#cb17-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a>Finally, we can do the calculations from above for different designs depending</span>
<span id="cb17-428"><a href="#cb17-428" aria-hidden="true" tabindex="-1"></a>on the interim information $I_1 \in <span class="sc">\{</span>0.3, 0.4, 0.5<span class="sc">\}</span>$ and</span>
<span id="cb17-429"><a href="#cb17-429" aria-hidden="true" tabindex="-1"></a>$I_{\Delta_t} \in <span class="sc">\{</span>0.1, 0.2, 0.3<span class="sc">\}</span>$ by iterating over the different scenarios</span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a>in a for-loop. Finally, we again plot the results for different settings using</span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a><span class="in">`facet_grid()`</span>. To obtain different scenarios, only input parameters must be</span>
<span id="cb17-432"><a href="#cb17-432" aria-hidden="true" tabindex="-1"></a>changed.</span>
<span id="cb17-433"><a href="#cb17-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-436"><a href="#cb17-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-437"><a href="#cb17-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a><span class="co"># Theme for multiple plots in one grid</span></span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a>theme_grid <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-442"><a href="#cb17-442" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-443"><a href="#cb17-443" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">"italic"</span></span>
<span id="cb17-448"><a href="#cb17-448" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb17-449"><a href="#cb17-449" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb17-452"><a href="#cb17-452" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb17-453"><a href="#cb17-453" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a><span class="co"># Design parameters</span></span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a>interimInformation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>)</span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a>alphaSpending <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"asP"</span>, <span class="st">"asOF"</span>)</span>
<span id="cb17-461"><a href="#cb17-461" aria-hidden="true" tabindex="-1"></a>betaSpending <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bsP"</span>, <span class="st">"bsOF"</span>)</span>
<span id="cb17-462"><a href="#cb17-462" aria-hidden="true" tabindex="-1"></a>delayedInformation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb17-463"><a href="#cb17-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-464"><a href="#cb17-464" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect, standard deviation and sample size</span></span>
<span id="cb17-465"><a href="#cb17-465" aria-hidden="true" tabindex="-1"></a>alternative <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="fl">0.05</span>)</span>
<span id="cb17-466"><a href="#cb17-466" aria-hidden="true" tabindex="-1"></a>nAlternative <span class="ot">&lt;-</span> <span class="fu">length</span>(alternative)</span>
<span id="cb17-467"><a href="#cb17-467" aria-hidden="true" tabindex="-1"></a>stDev <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-468"><a href="#cb17-468" aria-hidden="true" tabindex="-1"></a>maxNumberOfSubjects <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving all considered cases in a data.frame()</span></span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a>    <span class="at">interimInformation =</span> interimInformation,</span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a>    <span class="at">alphaSpending =</span> alphaSpending,</span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a>    <span class="at">betaSpending =</span> betaSpending,</span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> delayedInformation</span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a><span class="co"># Input for typeOfDesign and typeBetaSpending should be character value</span></span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a>cases<span class="sc">$</span>alphaSpending <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cases<span class="sc">$</span>alphaSpending)</span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a>cases<span class="sc">$</span>betaSpending <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cases<span class="sc">$</span>betaSpending)</span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only cases in which alpha and beta-spending match</span></span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">&lt;-</span> cases[(cases<span class="sc">$</span>alphaSpending <span class="sc">==</span> <span class="st">"asOF"</span> <span class="sc">&amp;</span> cases<span class="sc">$</span>betaSpending <span class="sc">==</span> <span class="st">"bsOF"</span>) <span class="sc">|</span></span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a>    (cases<span class="sc">$</span>alphaSpending <span class="sc">==</span> <span class="st">"asP"</span> <span class="sc">&amp;</span> cases<span class="sc">$</span>betaSpending <span class="sc">==</span> <span class="st">"bsP"</span>), ]</span>
<span id="cb17-485"><a href="#cb17-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-486"><a href="#cb17-486" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of cases</span></span>
<span id="cb17-487"><a href="#cb17-487" aria-hidden="true" tabindex="-1"></a>nCases <span class="ot">&lt;-</span> <span class="fu">nrow</span>(cases)</span>
<span id="cb17-488"><a href="#cb17-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-489"><a href="#cb17-489" aria-hidden="true" tabindex="-1"></a><span class="co"># The three different methpods</span></span>
<span id="cb17-490"><a href="#cb17-490" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, <span class="st">"drgsDesign"</span>, <span class="st">"drDesign"</span>)</span>
<span id="cb17-491"><a href="#cb17-491" aria-hidden="true" tabindex="-1"></a>nMethods <span class="ot">&lt;-</span> <span class="fu">length</span>(methods)</span>
<span id="cb17-492"><a href="#cb17-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-493"><a href="#cb17-493" aria-hidden="true" tabindex="-1"></a><span class="co"># Placeholder for the results of a single setting</span></span>
<span id="cb17-494"><a href="#cb17-494" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-495"><a href="#cb17-495" aria-hidden="true" tabindex="-1"></a>    <span class="at">interimInformation =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nMethods <span class="sc">*</span> nAlternative),</span>
<span id="cb17-496"><a href="#cb17-496" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nMethods <span class="sc">*</span> nAlternative),</span>
<span id="cb17-497"><a href="#cb17-497" aria-hidden="true" tabindex="-1"></a>    <span class="at">alphaSpending =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nMethods <span class="sc">*</span> nAlternative),</span>
<span id="cb17-498"><a href="#cb17-498" aria-hidden="true" tabindex="-1"></a>    <span class="at">betaSpending =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nMethods <span class="sc">*</span> nAlternative),</span>
<span id="cb17-499"><a href="#cb17-499" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="fu">rep</span>(alternative, nMethods),</span>
<span id="cb17-500"><a href="#cb17-500" aria-hidden="true" tabindex="-1"></a>    <span class="at">rejInterim =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb17-501"><a href="#cb17-501" aria-hidden="true" tabindex="-1"></a>    <span class="at">power =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb17-502"><a href="#cb17-502" aria-hidden="true" tabindex="-1"></a>    <span class="at">futility =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb17-503"><a href="#cb17-503" aria-hidden="true" tabindex="-1"></a>    <span class="at">expectedSampleSize =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAlternative <span class="sc">*</span> nMethods),</span>
<span id="cb17-504"><a href="#cb17-504" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">rep</span>(methods, <span class="at">each =</span> nAlternative)</span>
<span id="cb17-505"><a href="#cb17-505" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-506"><a href="#cb17-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-507"><a href="#cb17-507" aria-hidden="true" tabindex="-1"></a><span class="co"># List in which results for all settings will be saved as data.frame()</span></span>
<span id="cb17-508"><a href="#cb17-508" aria-hidden="true" tabindex="-1"></a>results_all <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-509"><a href="#cb17-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-510"><a href="#cb17-510" aria-hidden="true" tabindex="-1"></a><span class="co"># For-loop iterating over the different considered settings</span></span>
<span id="cb17-511"><a href="#cb17-511" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nCases) {</span>
<span id="cb17-512"><a href="#cb17-512" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialisation of gsDesign</span></span>
<span id="cb17-513"><a href="#cb17-513" aria-hidden="true" tabindex="-1"></a>    gsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb17-514"><a href="#cb17-514" aria-hidden="true" tabindex="-1"></a>        <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb17-515"><a href="#cb17-515" aria-hidden="true" tabindex="-1"></a>        <span class="at">informationRates =</span> <span class="fu">c</span>(cases<span class="sc">$</span>interimInformation[i], <span class="dv">1</span>),</span>
<span id="cb17-516"><a href="#cb17-516" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb17-517"><a href="#cb17-517" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb17-518"><a href="#cb17-518" aria-hidden="true" tabindex="-1"></a>        <span class="at">sided =</span> <span class="dv">1</span>,</span>
<span id="cb17-519"><a href="#cb17-519" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeOfDesign =</span> cases<span class="sc">$</span>alphaSpending[i],</span>
<span id="cb17-520"><a href="#cb17-520" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeBetaSpending =</span> cases<span class="sc">$</span>betaSpending[i],</span>
<span id="cb17-521"><a href="#cb17-521" aria-hidden="true" tabindex="-1"></a>        <span class="at">delayedInformation =</span> <span class="dv">0</span>,</span>
<span id="cb17-522"><a href="#cb17-522" aria-hidden="true" tabindex="-1"></a>        <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb17-523"><a href="#cb17-523" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-524"><a href="#cb17-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-525"><a href="#cb17-525" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nAlternative</span>
<span id="cb17-526"><a href="#cb17-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-527"><a href="#cb17-527" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Performance evaluation of gsDesign</span></span>
<span id="cb17-528"><a href="#cb17-528" aria-hidden="true" tabindex="-1"></a>    performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeans</span>(</span>
<span id="cb17-529"><a href="#cb17-529" aria-hidden="true" tabindex="-1"></a>        <span class="at">design =</span> gsDesign,</span>
<span id="cb17-530"><a href="#cb17-530" aria-hidden="true" tabindex="-1"></a>        <span class="at">groups =</span> <span class="dv">2</span>,</span>
<span id="cb17-531"><a href="#cb17-531" aria-hidden="true" tabindex="-1"></a>        <span class="at">normalApproximation =</span> T,</span>
<span id="cb17-532"><a href="#cb17-532" aria-hidden="true" tabindex="-1"></a>        <span class="at">alternative =</span> alternative,</span>
<span id="cb17-533"><a href="#cb17-533" aria-hidden="true" tabindex="-1"></a>        <span class="at">stDev =</span> stDev,</span>
<span id="cb17-534"><a href="#cb17-534" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb17-535"><a href="#cb17-535" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-536"><a href="#cb17-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-537"><a href="#cb17-537" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejectPerStage[<span class="dv">1</span>, ]</span>
<span id="cb17-538"><a href="#cb17-538" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>overallReject</span>
<span id="cb17-539"><a href="#cb17-539" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>futilityStop</span>
<span id="cb17-540"><a href="#cb17-540" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedNumberOfSubjects <span class="sc">+</span></span>
<span id="cb17-541"><a href="#cb17-541" aria-hidden="true" tabindex="-1"></a>        (cases<span class="sc">$</span>delayedInformation[i] <span class="sc">*</span> maxNumberOfSubjects) <span class="sc">*</span> performance<span class="sc">$</span>earlyStop</span>
<span id="cb17-542"><a href="#cb17-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-543"><a href="#cb17-543" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialisation of drgsDesign</span></span>
<span id="cb17-544"><a href="#cb17-544" aria-hidden="true" tabindex="-1"></a>    drgsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb17-545"><a href="#cb17-545" aria-hidden="true" tabindex="-1"></a>        <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb17-546"><a href="#cb17-546" aria-hidden="true" tabindex="-1"></a>        <span class="at">informationRates =</span> <span class="fu">c</span>(cases<span class="sc">$</span>interimInformation[i], <span class="dv">1</span>),</span>
<span id="cb17-547"><a href="#cb17-547" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb17-548"><a href="#cb17-548" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb17-549"><a href="#cb17-549" aria-hidden="true" tabindex="-1"></a>        <span class="at">sided =</span> <span class="dv">1</span>,</span>
<span id="cb17-550"><a href="#cb17-550" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeOfDesign =</span> cases<span class="sc">$</span>alphaSpending[i],</span>
<span id="cb17-551"><a href="#cb17-551" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeBetaSpending =</span> cases<span class="sc">$</span>betaSpending[i],</span>
<span id="cb17-552"><a href="#cb17-552" aria-hidden="true" tabindex="-1"></a>        <span class="at">delayedInformation =</span> cases<span class="sc">$</span>delayedInformation[i],</span>
<span id="cb17-553"><a href="#cb17-553" aria-hidden="true" tabindex="-1"></a>        <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb17-554"><a href="#cb17-554" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-555"><a href="#cb17-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-556"><a href="#cb17-556" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> nAlternative)<span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> nAlternative)</span>
<span id="cb17-557"><a href="#cb17-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-558"><a href="#cb17-558" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Performance evaluation of drgsDesign</span></span>
<span id="cb17-559"><a href="#cb17-559" aria-hidden="true" tabindex="-1"></a>    performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeans</span>(</span>
<span id="cb17-560"><a href="#cb17-560" aria-hidden="true" tabindex="-1"></a>        <span class="at">design =</span> drgsDesign,</span>
<span id="cb17-561"><a href="#cb17-561" aria-hidden="true" tabindex="-1"></a>        <span class="at">groups =</span> <span class="dv">2</span>,</span>
<span id="cb17-562"><a href="#cb17-562" aria-hidden="true" tabindex="-1"></a>        <span class="at">normalApproximation =</span> T,</span>
<span id="cb17-563"><a href="#cb17-563" aria-hidden="true" tabindex="-1"></a>        <span class="at">alternative =</span> alternative,</span>
<span id="cb17-564"><a href="#cb17-564" aria-hidden="true" tabindex="-1"></a>        <span class="at">stDev =</span> stDev,</span>
<span id="cb17-565"><a href="#cb17-565" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb17-566"><a href="#cb17-566" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-567"><a href="#cb17-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-568"><a href="#cb17-568" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejectPerStage[<span class="dv">1</span>, ]</span>
<span id="cb17-569"><a href="#cb17-569" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>overallReject</span>
<span id="cb17-570"><a href="#cb17-570" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedNumberOfSubjects</span>
<span id="cb17-571"><a href="#cb17-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-572"><a href="#cb17-572" aria-hidden="true" tabindex="-1"></a>    informationRatesUponDelay <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-573"><a href="#cb17-573" aria-hidden="true" tabindex="-1"></a>        drgsDesign<span class="sc">$</span>informationRates[<span class="dv">1</span>],</span>
<span id="cb17-574"><a href="#cb17-574" aria-hidden="true" tabindex="-1"></a>        drgsDesign<span class="sc">$</span>informationRates[<span class="dv">1</span>] <span class="sc">+</span> drgsDesign<span class="sc">$</span>delayedInformation[<span class="dv">1</span>], <span class="dv">1</span></span>
<span id="cb17-575"><a href="#cb17-575" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-576"><a href="#cb17-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-577"><a href="#cb17-577" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> <span class="fu">calcFutility</span>(</span>
<span id="cb17-578"><a href="#cb17-578" aria-hidden="true" tabindex="-1"></a>        <span class="at">fut =</span> drgsDesign<span class="sc">$</span>futilityBounds,</span>
<span id="cb17-579"><a href="#cb17-579" aria-hidden="true" tabindex="-1"></a>        <span class="at">crit =</span> drgsDesign<span class="sc">$</span>criticalValues,</span>
<span id="cb17-580"><a href="#cb17-580" aria-hidden="true" tabindex="-1"></a>        <span class="at">dec =</span> drgsDesign<span class="sc">$</span>decisionCriticalValues,</span>
<span id="cb17-581"><a href="#cb17-581" aria-hidden="true" tabindex="-1"></a>        <span class="at">alternative =</span> alternative,</span>
<span id="cb17-582"><a href="#cb17-582" aria-hidden="true" tabindex="-1"></a>        <span class="at">stDev =</span> stDev,</span>
<span id="cb17-583"><a href="#cb17-583" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects,</span>
<span id="cb17-584"><a href="#cb17-584" aria-hidden="true" tabindex="-1"></a>        <span class="at">informationRates =</span> informationRatesUponDelay</span>
<span id="cb17-585"><a href="#cb17-585" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-586"><a href="#cb17-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-587"><a href="#cb17-587" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialisation of drDesign</span></span>
<span id="cb17-588"><a href="#cb17-588" aria-hidden="true" tabindex="-1"></a>    drDesign <span class="ot">&lt;-</span> <span class="fu">getDoubleRejectionDesign</span>(</span>
<span id="cb17-589"><a href="#cb17-589" aria-hidden="true" tabindex="-1"></a>        <span class="at">informationRates =</span> <span class="fu">c</span>(cases<span class="sc">$</span>interimInformation[i], <span class="dv">1</span>),</span>
<span id="cb17-590"><a href="#cb17-590" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.025</span>,</span>
<span id="cb17-591"><a href="#cb17-591" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb17-592"><a href="#cb17-592" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeOfDesign =</span> cases<span class="sc">$</span>alphaSpending[i],</span>
<span id="cb17-593"><a href="#cb17-593" aria-hidden="true" tabindex="-1"></a>        <span class="at">typeBetaSpending =</span> cases<span class="sc">$</span>betaSpending[i],</span>
<span id="cb17-594"><a href="#cb17-594" aria-hidden="true" tabindex="-1"></a>        <span class="at">delayedInformation =</span> cases<span class="sc">$</span>delayedInformation[i]</span>
<span id="cb17-595"><a href="#cb17-595" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-596"><a href="#cb17-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-597"><a href="#cb17-597" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> nAlternative))<span class="sc">:</span>(<span class="dv">3</span> <span class="sc">*</span> nAlternative)</span>
<span id="cb17-598"><a href="#cb17-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-599"><a href="#cb17-599" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Performance evaluation of drDesign</span></span>
<span id="cb17-600"><a href="#cb17-600" aria-hidden="true" tabindex="-1"></a>    performance <span class="ot">&lt;-</span> <span class="fu">getPowerMeansDoubleRejectionApproach</span>(</span>
<span id="cb17-601"><a href="#cb17-601" aria-hidden="true" tabindex="-1"></a>        <span class="at">design =</span> drDesign,</span>
<span id="cb17-602"><a href="#cb17-602" aria-hidden="true" tabindex="-1"></a>        <span class="at">alternative =</span> alternative,</span>
<span id="cb17-603"><a href="#cb17-603" aria-hidden="true" tabindex="-1"></a>        <span class="at">stDev =</span> stDev,</span>
<span id="cb17-604"><a href="#cb17-604" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxNumberOfSubjects =</span> maxNumberOfSubjects</span>
<span id="cb17-605"><a href="#cb17-605" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-606"><a href="#cb17-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-607"><a href="#cb17-607" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Saving everything in results</span></span>
<span id="cb17-608"><a href="#cb17-608" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>rejInterim[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>rejInterim</span>
<span id="cb17-609"><a href="#cb17-609" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>power[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>power</span>
<span id="cb17-610"><a href="#cb17-610" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>futility[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>futility</span>
<span id="cb17-611"><a href="#cb17-611" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>expectedSampleSize[index] <span class="ot">&lt;-</span> performance<span class="sc">$</span>expectedSampleSize</span>
<span id="cb17-612"><a href="#cb17-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-613"><a href="#cb17-613" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save design characteristics as well</span></span>
<span id="cb17-614"><a href="#cb17-614" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>interimInformation <span class="ot">&lt;-</span> cases<span class="sc">$</span>interimInformation[i]</span>
<span id="cb17-615"><a href="#cb17-615" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>delayedInformation <span class="ot">&lt;-</span> cases<span class="sc">$</span>delayedInformation[i]</span>
<span id="cb17-616"><a href="#cb17-616" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>alphaSpending <span class="ot">&lt;-</span> cases<span class="sc">$</span>alphaSpending[i]</span>
<span id="cb17-617"><a href="#cb17-617" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>betaSpending <span class="ot">&lt;-</span> cases<span class="sc">$</span>betaSpending[i]</span>
<span id="cb17-618"><a href="#cb17-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-619"><a href="#cb17-619" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Saving results in the results_all list</span></span>
<span id="cb17-620"><a href="#cb17-620" aria-hidden="true" tabindex="-1"></a>    results_all[[i]] <span class="ot">&lt;-</span> results</span>
<span id="cb17-621"><a href="#cb17-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-622"><a href="#cb17-622" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Naming of the entries in results_all</span></span>
<span id="cb17-623"><a href="#cb17-623" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(results_all)[i] <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb17-624"><a href="#cb17-624" aria-hidden="true" tabindex="-1"></a>        cases<span class="sc">$</span>alphaSpending[i],</span>
<span id="cb17-625"><a href="#cb17-625" aria-hidden="true" tabindex="-1"></a>        cases<span class="sc">$</span>betaSpending[i], <span class="st">"I1="</span>, cases<span class="sc">$</span>interimInformation[i],</span>
<span id="cb17-626"><a href="#cb17-626" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Id ="</span>, cases<span class="sc">$</span>delayedInformation[i]</span>
<span id="cb17-627"><a href="#cb17-627" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-628"><a href="#cb17-628" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-629"><a href="#cb17-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-630"><a href="#cb17-630" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge results for all settings</span></span>
<span id="cb17-631"><a href="#cb17-631" aria-hidden="true" tabindex="-1"></a>results_all <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, results_all)</span>
<span id="cb17-632"><a href="#cb17-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-633"><a href="#cb17-633" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Pocock-like spending function; Change to "asOF" for O'Brien-Fleming-like spending function</span></span>
<span id="cb17-634"><a href="#cb17-634" aria-hidden="true" tabindex="-1"></a>results_all <span class="ot">&lt;-</span> results_all[results_all<span class="sc">$</span>alphaSpending <span class="sc">==</span> <span class="st">"asP"</span>, ]</span>
<span id="cb17-635"><a href="#cb17-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-636"><a href="#cb17-636" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilities plot</span></span>
<span id="cb17-637"><a href="#cb17-637" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(results_all, <span class="fu">aes</span>(<span class="at">x =</span> alternative, <span class="at">y =</span> power, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb17-638"><a href="#cb17-638" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.9</span>, <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">"Power"</span>)) <span class="sc">+</span></span>
<span id="cb17-639"><a href="#cb17-639" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.9</span>, <span class="fu">aes</span>(</span>
<span id="cb17-640"><a href="#cb17-640" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> alternative, <span class="at">y =</span> rejInterim,</span>
<span id="cb17-641"><a href="#cb17-641" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> method, <span class="at">linetype =</span> <span class="st">"Rej.Interim"</span></span>
<span id="cb17-642"><a href="#cb17-642" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb17-643"><a href="#cb17-643" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.9</span>, <span class="fu">aes</span>(</span>
<span id="cb17-644"><a href="#cb17-644" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> alternative, <span class="at">y =</span> futility,</span>
<span id="cb17-645"><a href="#cb17-645" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> method, <span class="at">linetype =</span> <span class="st">"Futility"</span></span>
<span id="cb17-646"><a href="#cb17-646" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb17-647"><a href="#cb17-647" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(delayedInformation), <span class="at">cols =</span> <span class="fu">vars</span>(interimInformation)) <span class="sc">+</span></span>
<span id="cb17-648"><a href="#cb17-648" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(delta)) <span class="sc">+</span></span>
<span id="cb17-649"><a href="#cb17-649" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb17-650"><a href="#cb17-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb17-651"><a href="#cb17-651" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative)),</span>
<span id="cb17-652"><a href="#cb17-652" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative), <span class="fl">0.2</span>), <span class="dv">3</span>),</span>
<span id="cb17-653"><a href="#cb17-653" aria-hidden="true" tabindex="-1"></a>        <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.,</span>
<span id="cb17-654"><a href="#cb17-654" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Interim Information "</span>, I[<span class="dv">1</span>])),</span>
<span id="cb17-655"><a href="#cb17-655" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="cn">NULL</span></span>
<span id="cb17-656"><a href="#cb17-656" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb17-657"><a href="#cb17-657" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-658"><a href="#cb17-658" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.,</span>
<span id="cb17-659"><a href="#cb17-659" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Amount of Pipeline Data "</span>, I[Delta[t]])),</span>
<span id="cb17-660"><a href="#cb17-660" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="cn">NULL</span></span>
<span id="cb17-661"><a href="#cb17-661" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb17-662"><a href="#cb17-662" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb17-663"><a href="#cb17-663" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb17-664"><a href="#cb17-664" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb17-665"><a href="#cb17-665" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Power"</span> <span class="ot">=</span> <span class="st">"solid"</span>,</span>
<span id="cb17-666"><a href="#cb17-666" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Rej.Interim"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"Futility"</span> <span class="ot">=</span> <span class="st">"dotted"</span></span>
<span id="cb17-667"><a href="#cb17-667" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb17-668"><a href="#cb17-668" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"Power"</span>, <span class="st">"Rej.Interim"</span>, <span class="st">"Futility"</span>)</span>
<span id="cb17-669"><a href="#cb17-669" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-670"><a href="#cb17-670" aria-hidden="true" tabindex="-1"></a>    theme_grid</span>
<span id="cb17-671"><a href="#cb17-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-672"><a href="#cb17-672" aria-hidden="true" tabindex="-1"></a><span class="co"># If the lines are overlapping, geom_path() can be used alternatively to</span></span>
<span id="cb17-673"><a href="#cb17-673" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_line() to slightly shift the lines using position_dodge();</span></span>
<span id="cb17-674"><a href="#cb17-674" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment the code below in that case.</span></span>
<span id="cb17-675"><a href="#cb17-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-676"><a href="#cb17-676" aria-hidden="true" tabindex="-1"></a><span class="co"># power &lt;- ggplot(results_all, aes(x = alternative, y = power, color = method)) +</span></span>
<span id="cb17-677"><a href="#cb17-677" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(position = position_dodge(width = 0.02), size = 0.9, aes(linetype = "Power")) +</span></span>
<span id="cb17-678"><a href="#cb17-678" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(position = position_dodge(width = 0.02), size = 0.9, aes(x = alternative, y = rejInterim, group = method, linetype = "Rej.Interim")) +</span></span>
<span id="cb17-679"><a href="#cb17-679" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(position = position_dodge(width = 0.02), size = 0.9, aes(x = alternative, y = futility, group = method, linetype = "Futility")) +</span></span>
<span id="cb17-680"><a href="#cb17-680" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(rows = vars(delayedInformation), cols = vars(interimInformation)) +</span></span>
<span id="cb17-681"><a href="#cb17-681" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab(expression(delta)) +</span></span>
<span id="cb17-682"><a href="#cb17-682" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Probability") +</span></span>
<span id="cb17-683"><a href="#cb17-683" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(limits = c(min(alternative), max(alternative)), breaks = round(seq(min(alternative),max(alternative),0.2),3),</span></span>
<span id="cb17-684"><a href="#cb17-684" aria-hidden="true" tabindex="-1"></a><span class="co">#                      sec.axis = sec_axis(~ . , name = expression(paste("Interim Information ", I[1])), breaks = NULL, labels = NULL)) +</span></span>
<span id="cb17-685"><a href="#cb17-685" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(sec.axis = sec_axis(~ . , name = expression(paste("Amount of Pipeline Data ", I[Delta[t]])), breaks = NULL, labels = NULL)) +</span></span>
<span id="cb17-686"><a href="#cb17-686" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_manual(values = c("seagreen", "orange2", "blue")) +</span></span>
<span id="cb17-687"><a href="#cb17-687" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_linetype_manual(values = c("Power" = "solid", "Rej.Interim" = "dashed", "Futility" = "dotted"), breaks = c("Power", "Rej.Interim", "Futility")) +</span></span>
<span id="cb17-688"><a href="#cb17-688" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_grid</span></span>
<span id="cb17-689"><a href="#cb17-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-690"><a href="#cb17-690" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected sample size plot</span></span>
<span id="cb17-691"><a href="#cb17-691" aria-hidden="true" tabindex="-1"></a>eN <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(results_all, <span class="fu">aes</span>(<span class="at">x =</span> alternative, <span class="at">y =</span> expectedSampleSize, <span class="at">linetype =</span> method, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb17-692"><a href="#cb17-692" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb17-693"><a href="#cb17-693" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(delayedInformation), <span class="at">cols =</span> <span class="fu">vars</span>(interimInformation), <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb17-694"><a href="#cb17-694" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(delta)) <span class="sc">+</span></span>
<span id="cb17-695"><a href="#cb17-695" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"E[N]"</span>) <span class="sc">+</span></span>
<span id="cb17-696"><a href="#cb17-696" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb17-697"><a href="#cb17-697" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative)), <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(alternative), <span class="fu">max</span>(alternative), <span class="fl">0.2</span>), <span class="dv">3</span>),</span>
<span id="cb17-698"><a href="#cb17-698" aria-hidden="true" tabindex="-1"></a>        <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>., <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Interim Information "</span>, I[<span class="dv">1</span>])), <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="cn">NULL</span>)</span>
<span id="cb17-699"><a href="#cb17-699" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-700"><a href="#cb17-700" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>., <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Amount of Pipeline Data "</span>, I[Delta[t]])), <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="cn">NULL</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">400</span>)) <span class="sc">+</span></span>
<span id="cb17-701"><a href="#cb17-701" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb17-702"><a href="#cb17-702" aria-hidden="true" tabindex="-1"></a>    theme_grid</span>
<span id="cb17-703"><a href="#cb17-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-704"><a href="#cb17-704" aria-hidden="true" tabindex="-1"></a><span class="co"># If the lines are overlapping, geom_path() can be used alternatively to geom_line() to slightly shift the lines using position_dodge() ; Uncomment the code below in that case</span></span>
<span id="cb17-705"><a href="#cb17-705" aria-hidden="true" tabindex="-1"></a><span class="co"># eN &lt;- ggplot(results_all, aes(x = alternative, y = expectedSampleSize, linetype = method, color = method)) +</span></span>
<span id="cb17-706"><a href="#cb17-706" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(position = position_dodge(width = 0.02), size = 0.9) +  # Using geom_path instead of geom_line for dodging</span></span>
<span id="cb17-707"><a href="#cb17-707" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(rows = vars(delayedInformation), cols = vars(interimInformation), scales = "free") +</span></span>
<span id="cb17-708"><a href="#cb17-708" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab(expression(delta)) +</span></span>
<span id="cb17-709"><a href="#cb17-709" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("E[N]") +</span></span>
<span id="cb17-710"><a href="#cb17-710" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(limits = c(min(alternative), max(alternative)), breaks = round(seq(min(alternative),max(alternative),0.2),3),</span></span>
<span id="cb17-711"><a href="#cb17-711" aria-hidden="true" tabindex="-1"></a><span class="co">#                      sec.axis = sec_axis(~ . , name = expression(paste("Interim Information ", I[1])), breaks = NULL, labels = NULL)) +</span></span>
<span id="cb17-712"><a href="#cb17-712" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(sec.axis = sec_axis(~ . , name = expression(paste("Amount of Pipeline Data ", I[Delta[t]])), breaks = NULL, labels = NULL), limits = c(160, 400)) +</span></span>
<span id="cb17-713"><a href="#cb17-713" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_manual(values = c("seagreen", "orange2", "blue")) +</span></span>
<span id="cb17-714"><a href="#cb17-714" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_grid</span></span>
<span id="cb17-715"><a href="#cb17-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-716"><a href="#cb17-716" aria-hidden="true" tabindex="-1"></a>power</span>
<span id="cb17-717"><a href="#cb17-717" aria-hidden="true" tabindex="-1"></a>eN</span>
<span id="cb17-718"><a href="#cb17-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-719"><a href="#cb17-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-720"><a href="#cb17-720" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simulation of Expected Sample Size</span></span>
<span id="cb17-721"><a href="#cb17-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-722"><a href="#cb17-722" aria-hidden="true" tabindex="-1"></a>The actual sample size as well as the power are directly dependent upon the</span>
<span id="cb17-723"><a href="#cb17-723" aria-hidden="true" tabindex="-1"></a>joint distribution of the test statistics. If the statistics are known to follow</span>
<span id="cb17-724"><a href="#cb17-724" aria-hidden="true" tabindex="-1"></a>a normal distribution, formulas to do calculations of location components are</span>
<span id="cb17-725"><a href="#cb17-725" aria-hidden="true" tabindex="-1"></a>readily available. In our manuscript, we argue that also variance components</span>
<span id="cb17-726"><a href="#cb17-726" aria-hidden="true" tabindex="-1"></a>(such as $Var_{\delta}(N)$) should be considered in performance evaluation.</span>
<span id="cb17-727"><a href="#cb17-727" aria-hidden="true" tabindex="-1"></a>However, no straightforward formulas for the calculation of the variance of</span>
<span id="cb17-728"><a href="#cb17-728" aria-hidden="true" tabindex="-1"></a>sample size and power exist. Therefore, we use simulation to obtain an empirical</span>
<span id="cb17-729"><a href="#cb17-729" aria-hidden="true" tabindex="-1"></a>distribution of the random variables.</span>
<span id="cb17-730"><a href="#cb17-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-733"><a href="#cb17-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-734"><a href="#cb17-734" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb17-735"><a href="#cb17-735" aria-hidden="true" tabindex="-1"></a>maxNumberOfSubjects <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb17-736"><a href="#cb17-736" aria-hidden="true" tabindex="-1"></a>interimInformation <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb17-737"><a href="#cb17-737" aria-hidden="true" tabindex="-1"></a>delayedInformation <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb17-738"><a href="#cb17-738" aria-hidden="true" tabindex="-1"></a>alternative <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb17-739"><a href="#cb17-739" aria-hidden="true" tabindex="-1"></a>stDev <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-740"><a href="#cb17-740" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb17-741"><a href="#cb17-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-742"><a href="#cb17-742" aria-hidden="true" tabindex="-1"></a><span class="co"># Design parameters</span></span>
<span id="cb17-743"><a href="#cb17-743" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.025</span></span>
<span id="cb17-744"><a href="#cb17-744" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb17-745"><a href="#cb17-745" aria-hidden="true" tabindex="-1"></a>informationRates <span class="ot">&lt;-</span> <span class="fu">c</span>(interimInformation, <span class="dv">1</span>)</span>
<span id="cb17-746"><a href="#cb17-746" aria-hidden="true" tabindex="-1"></a>typeOfDesign <span class="ot">&lt;-</span> <span class="st">"asOF"</span></span>
<span id="cb17-747"><a href="#cb17-747" aria-hidden="true" tabindex="-1"></a>typeBetaSpending <span class="ot">&lt;-</span> <span class="st">"bsOF"</span></span>
<span id="cb17-748"><a href="#cb17-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-749"><a href="#cb17-749" aria-hidden="true" tabindex="-1"></a><span class="co"># True means and covariance matrix</span></span>
<span id="cb17-750"><a href="#cb17-750" aria-hidden="true" tabindex="-1"></a>informationRatesUponDelay <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-751"><a href="#cb17-751" aria-hidden="true" tabindex="-1"></a>    interimInformation,</span>
<span id="cb17-752"><a href="#cb17-752" aria-hidden="true" tabindex="-1"></a>    interimInformation <span class="sc">+</span> delayedInformation, <span class="dv">1</span></span>
<span id="cb17-753"><a href="#cb17-753" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-754"><a href="#cb17-754" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> alternative <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> stDev<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span></span>
<span id="cb17-755"><a href="#cb17-755" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(informationRatesUponDelay <span class="sc">*</span> maxNumberOfSubjects <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb17-756"><a href="#cb17-756" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">getCovarianceFromInformation</span>(informationRatesUponDelay)</span>
<span id="cb17-757"><a href="#cb17-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-758"><a href="#cb17-758" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frame to store results</span></span>
<span id="cb17-759"><a href="#cb17-759" aria-hidden="true" tabindex="-1"></a>resultsSim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-760"><a href="#cb17-760" aria-hidden="true" tabindex="-1"></a>    <span class="at">Method =</span> <span class="fu">character</span>(nsim),</span>
<span id="cb17-761"><a href="#cb17-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">Power =</span> <span class="fu">numeric</span>(nsim),</span>
<span id="cb17-762"><a href="#cb17-762" aria-hidden="true" tabindex="-1"></a>    <span class="at">expectedNumberOfSubjects =</span> <span class="fu">numeric</span>(nsim),</span>
<span id="cb17-763"><a href="#cb17-763" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb17-764"><a href="#cb17-764" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-765"><a href="#cb17-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-766"><a href="#cb17-766" aria-hidden="true" tabindex="-1"></a><span class="co"># Group-sequential design</span></span>
<span id="cb17-767"><a href="#cb17-767" aria-hidden="true" tabindex="-1"></a>gsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb17-768"><a href="#cb17-768" aria-hidden="true" tabindex="-1"></a>    <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb17-769"><a href="#cb17-769" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha,</span>
<span id="cb17-770"><a href="#cb17-770" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> beta,</span>
<span id="cb17-771"><a href="#cb17-771" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb17-772"><a href="#cb17-772" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> typeOfDesign,</span>
<span id="cb17-773"><a href="#cb17-773" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> typeBetaSpending,</span>
<span id="cb17-774"><a href="#cb17-774" aria-hidden="true" tabindex="-1"></a>    <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb17-775"><a href="#cb17-775" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-776"><a href="#cb17-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-777"><a href="#cb17-777" aria-hidden="true" tabindex="-1"></a><span class="co"># Delayed response group-sequential design</span></span>
<span id="cb17-778"><a href="#cb17-778" aria-hidden="true" tabindex="-1"></a>drgsDesign <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(</span>
<span id="cb17-779"><a href="#cb17-779" aria-hidden="true" tabindex="-1"></a>    <span class="at">kMax =</span> <span class="dv">2</span>,</span>
<span id="cb17-780"><a href="#cb17-780" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha,</span>
<span id="cb17-781"><a href="#cb17-781" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> beta,</span>
<span id="cb17-782"><a href="#cb17-782" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb17-783"><a href="#cb17-783" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> typeOfDesign,</span>
<span id="cb17-784"><a href="#cb17-784" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> delayedInformation,</span>
<span id="cb17-785"><a href="#cb17-785" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> typeBetaSpending,</span>
<span id="cb17-786"><a href="#cb17-786" aria-hidden="true" tabindex="-1"></a>    <span class="at">bindingFutility =</span> <span class="cn">FALSE</span></span>
<span id="cb17-787"><a href="#cb17-787" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-788"><a href="#cb17-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-789"><a href="#cb17-789" aria-hidden="true" tabindex="-1"></a><span class="co"># Double Rejection Design</span></span>
<span id="cb17-790"><a href="#cb17-790" aria-hidden="true" tabindex="-1"></a>drDesign <span class="ot">&lt;-</span> <span class="fu">getDoubleRejectionDesign</span>(</span>
<span id="cb17-791"><a href="#cb17-791" aria-hidden="true" tabindex="-1"></a>    <span class="at">informationRates =</span> informationRates,</span>
<span id="cb17-792"><a href="#cb17-792" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha,</span>
<span id="cb17-793"><a href="#cb17-793" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> beta,</span>
<span id="cb17-794"><a href="#cb17-794" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeOfDesign =</span> typeOfDesign,</span>
<span id="cb17-795"><a href="#cb17-795" aria-hidden="true" tabindex="-1"></a>    <span class="at">typeBetaSpending =</span> typeBetaSpending,</span>
<span id="cb17-796"><a href="#cb17-796" aria-hidden="true" tabindex="-1"></a>    <span class="at">delayedInformation =</span> delayedInformation</span>
<span id="cb17-797"><a href="#cb17-797" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-798"><a href="#cb17-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-799"><a href="#cb17-799" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="dv">19032024</span></span>
<span id="cb17-800"><a href="#cb17-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-801"><a href="#cb17-801" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb17-802"><a href="#cb17-802" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed <span class="sc">+</span> i)</span>
<span id="cb17-803"><a href="#cb17-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-804"><a href="#cb17-804" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulating multivariate normal random variables as test statistics</span></span>
<span id="cb17-805"><a href="#cb17-805" aria-hidden="true" tabindex="-1"></a>    statistics <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> mu, <span class="at">sigma =</span> sigma)</span>
<span id="cb17-806"><a href="#cb17-806" aria-hidden="true" tabindex="-1"></a>    Z1 <span class="ot">&lt;-</span> statistics[, <span class="dv">1</span>]</span>
<span id="cb17-807"><a href="#cb17-807" aria-hidden="true" tabindex="-1"></a>    Z1tilde <span class="ot">&lt;-</span> statistics[, <span class="dv">2</span>]</span>
<span id="cb17-808"><a href="#cb17-808" aria-hidden="true" tabindex="-1"></a>    Z12 <span class="ot">&lt;-</span> statistics[, <span class="dv">3</span>]</span>
<span id="cb17-809"><a href="#cb17-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-810"><a href="#cb17-810" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate power and expected sample size values for all designs</span></span>
<span id="cb17-811"><a href="#cb17-811" aria-hidden="true" tabindex="-1"></a>    powerGSD <span class="ot">&lt;-</span> <span class="fu">mean</span>((Z1 <span class="sc">&gt;</span> gsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>]) <span class="sc">|</span></span>
<span id="cb17-812"><a href="#cb17-812" aria-hidden="true" tabindex="-1"></a>        (gsDesign<span class="sc">$</span>futilityBounds <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span> Z1 <span class="sc">&lt;</span> gsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb17-813"><a href="#cb17-813" aria-hidden="true" tabindex="-1"></a>            Z12 <span class="sc">&gt;</span> gsDesign<span class="sc">$</span>criticalValues[<span class="dv">2</span>]))</span>
<span id="cb17-814"><a href="#cb17-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-815"><a href="#cb17-815" aria-hidden="true" tabindex="-1"></a>    eNGSD <span class="ot">&lt;-</span> <span class="fu">mean</span>(informationRatesUponDelay[<span class="dv">2</span>] <span class="sc">*</span></span>
<span id="cb17-816"><a href="#cb17-816" aria-hidden="true" tabindex="-1"></a>        maxNumberOfSubjects <span class="sc">*</span> (Z1 <span class="sc">&gt;</span> gsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>] <span class="sc">|</span></span>
<span id="cb17-817"><a href="#cb17-817" aria-hidden="true" tabindex="-1"></a>            (Z1 <span class="sc">&lt;</span> gsDesign<span class="sc">$</span>futilityBounds[<span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb17-818"><a href="#cb17-818" aria-hidden="true" tabindex="-1"></a>        maxNumberOfSubjects <span class="sc">*</span> (gsDesign<span class="sc">$</span>futilityBounds <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span> Z1 <span class="sc">&lt;</span> gsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>]))</span>
<span id="cb17-819"><a href="#cb17-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-820"><a href="#cb17-820" aria-hidden="true" tabindex="-1"></a>    powerDRGSD <span class="ot">&lt;-</span> <span class="fu">mean</span>((Z1 <span class="sc">&gt;</span> drgsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb17-821"><a href="#cb17-821" aria-hidden="true" tabindex="-1"></a>        Z1tilde <span class="sc">&gt;</span> drgsDesign<span class="sc">$</span>decisionCriticalValues[<span class="dv">1</span>]) <span class="sc">|</span></span>
<span id="cb17-822"><a href="#cb17-822" aria-hidden="true" tabindex="-1"></a>        (Z1 <span class="sc">&lt;</span> drgsDesign<span class="sc">$</span>futilityBounds[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb17-823"><a href="#cb17-823" aria-hidden="true" tabindex="-1"></a>            Z1tilde <span class="sc">&gt;</span> drgsDesign<span class="sc">$</span>decisionCriticalValues[<span class="dv">1</span>]) <span class="sc">|</span></span>
<span id="cb17-824"><a href="#cb17-824" aria-hidden="true" tabindex="-1"></a>        (drgsDesign<span class="sc">$</span>futilityBounds[<span class="dv">1</span>] <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span></span>
<span id="cb17-825"><a href="#cb17-825" aria-hidden="true" tabindex="-1"></a>            Z1 <span class="sc">&lt;</span> drgsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb17-826"><a href="#cb17-826" aria-hidden="true" tabindex="-1"></a>            Z12 <span class="sc">&gt;</span> drgsDesign<span class="sc">$</span>decisionCriticalValues[<span class="dv">2</span>]))</span>
<span id="cb17-827"><a href="#cb17-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-828"><a href="#cb17-828" aria-hidden="true" tabindex="-1"></a>    eNDRGSD <span class="ot">&lt;-</span> <span class="fu">mean</span>(informationRatesUponDelay[<span class="dv">2</span>] <span class="sc">*</span> maxNumberOfSubjects <span class="sc">*</span></span>
<span id="cb17-829"><a href="#cb17-829" aria-hidden="true" tabindex="-1"></a>        ((Z1 <span class="sc">&gt;</span> drgsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>]) <span class="sc">|</span></span>
<span id="cb17-830"><a href="#cb17-830" aria-hidden="true" tabindex="-1"></a>            (Z1 <span class="sc">&lt;</span> drgsDesign<span class="sc">$</span>futilityBounds[<span class="dv">1</span>])) <span class="sc">+</span> maxNumberOfSubjects <span class="sc">*</span></span>
<span id="cb17-831"><a href="#cb17-831" aria-hidden="true" tabindex="-1"></a>            (drgsDesign<span class="sc">$</span>futilityBounds[<span class="dv">1</span>] <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span> Z1 <span class="sc">&lt;</span> drgsDesign<span class="sc">$</span>criticalValues[<span class="dv">1</span>]))</span>
<span id="cb17-832"><a href="#cb17-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-833"><a href="#cb17-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-834"><a href="#cb17-834" aria-hidden="true" tabindex="-1"></a>    powerDRD <span class="ot">&lt;-</span> <span class="fu">mean</span>((Z1 <span class="sc">&gt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">1</span>] <span class="sc">&amp;</span> Z1tilde <span class="sc">&gt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">2</span>]) <span class="sc">|</span></span>
<span id="cb17-835"><a href="#cb17-835" aria-hidden="true" tabindex="-1"></a>        (drDesign<span class="sc">$</span>lower[<span class="dv">1</span>] <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span> Z1 <span class="sc">&lt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">1</span>] <span class="sc">&amp;</span> Z12 <span class="sc">&gt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">3</span>]))</span>
<span id="cb17-836"><a href="#cb17-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-837"><a href="#cb17-837" aria-hidden="true" tabindex="-1"></a>    enDRD <span class="ot">&lt;-</span> <span class="fu">mean</span>(informationRatesUponDelay[<span class="dv">2</span>] <span class="sc">*</span> maxNumberOfSubjects <span class="sc">*</span></span>
<span id="cb17-838"><a href="#cb17-838" aria-hidden="true" tabindex="-1"></a>        (Z1 <span class="sc">&gt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">1</span>] <span class="sc">|</span> Z1 <span class="sc">&lt;</span> drDesign<span class="sc">$</span>lower[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb17-839"><a href="#cb17-839" aria-hidden="true" tabindex="-1"></a>        maxNumberOfSubjects <span class="sc">*</span> (drDesign<span class="sc">$</span>lower[<span class="dv">1</span>] <span class="sc">&lt;</span> Z1 <span class="sc">&amp;</span> Z1 <span class="sc">&lt;</span> drDesign<span class="sc">$</span>upper[<span class="dv">1</span>]))</span>
<span id="cb17-840"><a href="#cb17-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-841"><a href="#cb17-841" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save results in data frame</span></span>
<span id="cb17-842"><a href="#cb17-842" aria-hidden="true" tabindex="-1"></a>    resultsSim[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, powerGSD, eNGSD)</span>
<span id="cb17-843"><a href="#cb17-843" aria-hidden="true" tabindex="-1"></a>    resultsSim[i <span class="sc">+</span> nsim, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"drgsDesign"</span>, powerDRGSD, eNDRGSD)</span>
<span id="cb17-844"><a href="#cb17-844" aria-hidden="true" tabindex="-1"></a>    resultsSim[i <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> nsim, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"drDesign"</span>, powerDRD, enDRD)</span>
<span id="cb17-845"><a href="#cb17-845" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-846"><a href="#cb17-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-847"><a href="#cb17-847" aria-hidden="true" tabindex="-1"></a><span class="co"># Save results</span></span>
<span id="cb17-848"><a href="#cb17-848" aria-hidden="true" tabindex="-1"></a>resultsSim<span class="sc">$</span>Method <span class="ot">&lt;-</span> <span class="fu">factor</span>(resultsSim<span class="sc">$</span>Method,</span>
<span id="cb17-849"><a href="#cb17-849" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, <span class="st">"drgsDesign"</span>, <span class="st">"drDesign"</span>),</span>
<span id="cb17-850"><a href="#cb17-850" aria-hidden="true" tabindex="-1"></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb17-851"><a href="#cb17-851" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-852"><a href="#cb17-852" aria-hidden="true" tabindex="-1"></a>resultsSim<span class="sc">$</span>Power <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(resultsSim<span class="sc">$</span>Power)</span>
<span id="cb17-853"><a href="#cb17-853" aria-hidden="true" tabindex="-1"></a>resultsSim<span class="sc">$</span>eN <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(resultsSim<span class="sc">$</span>expectedNumberOfSubjects)</span>
<span id="cb17-854"><a href="#cb17-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-855"><a href="#cb17-855" aria-hidden="true" tabindex="-1"></a><span class="co"># Theme for plotting simulation results</span></span>
<span id="cb17-856"><a href="#cb17-856" aria-hidden="true" tabindex="-1"></a>theme_sim <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-857"><a href="#cb17-857" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-858"><a href="#cb17-858" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb17-859"><a href="#cb17-859" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-860"><a href="#cb17-860" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb17-861"><a href="#cb17-861" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb17-862"><a href="#cb17-862" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb17-863"><a href="#cb17-863" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb17-864"><a href="#cb17-864" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb17-865"><a href="#cb17-865" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-866"><a href="#cb17-866" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb17-867"><a href="#cb17-867" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb17-868"><a href="#cb17-868" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-869"><a href="#cb17-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-870"><a href="#cb17-870" aria-hidden="true" tabindex="-1"></a><span class="co"># Power simulation</span></span>
<span id="cb17-871"><a href="#cb17-871" aria-hidden="true" tabindex="-1"></a>power_sim <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(resultsSim, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> Power, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb17-872"><a href="#cb17-872" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb17-873"><a href="#cb17-873" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, <span class="st">"drgsDesign"</span>, <span class="st">"drDesign"</span>)) <span class="sc">+</span></span>
<span id="cb17-874"><a href="#cb17-874" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.82</span>, <span class="fl">0.85</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.82</span>, <span class="fl">0.83</span>, <span class="fl">0.84</span>, <span class="fl">0.85</span>)) <span class="sc">+</span></span>
<span id="cb17-875"><a href="#cb17-875" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb17-876"><a href="#cb17-876" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Simulated Power"</span>) <span class="sc">+</span></span>
<span id="cb17-877"><a href="#cb17-877" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen4"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb17-878"><a href="#cb17-878" aria-hidden="true" tabindex="-1"></a>    theme_sim</span>
<span id="cb17-879"><a href="#cb17-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-880"><a href="#cb17-880" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected sample size simulation</span></span>
<span id="cb17-881"><a href="#cb17-881" aria-hidden="true" tabindex="-1"></a>eN_sim <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(resultsSim, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> eN, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb17-882"><a href="#cb17-882" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb17-883"><a href="#cb17-883" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"gsDesign"</span>, <span class="st">"drgsDesign"</span>, <span class="st">"drDesign"</span>)) <span class="sc">+</span></span>
<span id="cb17-884"><a href="#cb17-884" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">366</span>, <span class="dv">372</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">366</span>, <span class="dv">368</span>, <span class="dv">370</span>, <span class="dv">372</span>)) <span class="sc">+</span></span>
<span id="cb17-885"><a href="#cb17-885" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb17-886"><a href="#cb17-886" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"E[N]"</span>) <span class="sc">+</span></span>
<span id="cb17-887"><a href="#cb17-887" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"seagreen4"</span>, <span class="st">"orange2"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb17-888"><a href="#cb17-888" aria-hidden="true" tabindex="-1"></a>    theme_sim</span>
<span id="cb17-889"><a href="#cb17-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-890"><a href="#cb17-890" aria-hidden="true" tabindex="-1"></a>power_sim</span>
<span id="cb17-891"><a href="#cb17-891" aria-hidden="true" tabindex="-1"></a>eN_sim</span>
<span id="cb17-892"><a href="#cb17-892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-893"><a href="#cb17-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-894"><a href="#cb17-894" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb17-895"><a href="#cb17-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-896"><a href="#cb17-896" aria-hidden="true" tabindex="-1"></a>System: rpact <span class="in">`r  packageVersion("rpact")`</span>, <span class="in">`r R.version.string`</span>,</span>
<span id="cb17-897"><a href="#cb17-897" aria-hidden="true" tabindex="-1"></a>platform: <span class="in">`r R.version$platform`</span></span>
<span id="cb17-898"><a href="#cb17-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-899"><a href="#cb17-899" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE, results = 'asis'}</span></span>
<span id="cb17-900"><a href="#cb17-900" aria-hidden="true" tabindex="-1"></a><span class="in">printCitation()</span></span>
<span id="cb17-901"><a href="#cb17-901" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>